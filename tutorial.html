


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tutorial &#8212; xonsh 0.11.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/numpy_friendly.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/runthis-client.min.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="_static/magic_conch.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial: History" href="tutorial_hist.html" />
    <link rel="prev" title="Xonsh kernel for Jupyter" href="jupyter.html" />
     
        <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://xon.sh/tutorial.html"/>

  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="tutorial_hist.html" title="Tutorial: History"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="jupyter.html" title="Xonsh kernel for Jupyter"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="contents.html">xonsh 0.11.0 documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Tutorial</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="tutorial">
<span id="id1"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>xonsh is a shell language and command prompt. Unlike other shells, xonsh is
based on Python, with additional syntax added that makes calling subprocess
commands, manipulating the environment, and dealing with the file system
easy.  The xonsh command prompt gives users interactive access to the xonsh
language.</p>
<p>While all Python code is also xonsh, not all Bash code can be used in xonsh.
That would defeat the purpose, and Python is better anyway! Still, xonsh is
Bash-wards compatible in the ways that matter, such as for running commands,
reading in the Bash environment, and utilizing Bash tab completion.</p>
<p>The purpose of this tutorial is to teach you xonsh. There are many excellent
guides out there for learning Python, and this will not join their ranks.
Similarly, you’d probably get the most out of this tutorial if you have already
used a command prompt or interactive interpreter.</p>
<p>Let’s dive in!</p>
<section id="starting-xonsh">
<h2>Starting xonsh<a class="headerlink" href="#starting-xonsh" title="Permalink to this headline">¶</a></h2>
<p>Assuming you have successfully installed xonsh (see <a class="reference external" href="http://xon.sh">http://xon.sh</a>),
you can start up the xonsh interpreter via the <code class="docutils literal notranslate"><span class="pre">xonsh</span></code> command. Suppose
you are in a lesser terminal:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xonsh
<span class="gp">snail@home ~ $</span>
</pre></div>
</div>
<p>Now we are in a xonsh shell. Our username happens to be <code class="docutils literal notranslate"><span class="pre">snail</span></code>, our
hostname happens to be <code class="docutils literal notranslate"><span class="pre">home</span></code>, and we are in our home directory (<code class="docutils literal notranslate"><span class="pre">~</span></code>).
Alternatively, you can setup your terminal emulator (xterm, gnome-terminal,
etc) to run xonsh automatically when it starts up. This is recommended.</p>
</section>
<section id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<p>The xonsh language is based on Python, and the xonsh shell uses Python to
interpret any input it receives. This makes simple things, like arithmetic,
simple:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="go"></span>
<span class="go">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From here on we’ll be using <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> to prefix (or prompt) any
xonsh input. This follows the Python convention and helps trick
syntax highlighting, though <code class="docutils literal notranslate"><span class="pre">$</span></code> is more traditional for shells.</p>
</div>
<p>Since this is just Python, we are able to import modules, print values,
and use other built-in Python functionality:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span><span class="go"></span>
<span class="go">3.4.2 |Continuum Analytics, Inc.| (default, Oct 21 2014, 17:16:37)</span>
<span class="go">[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]</span>
</pre></div>
</div>
<p>We can also create and use literal data types, such as ints, floats, lists,
sets, and dictionaries. Everything that you are used to if you already know
Python is there:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xonsh&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span><span class="go"></span>
<span class="go">False</span>
</pre></div>
</div>
<p>The xonsh shell also supports multi-line input for more advanced flow control.
The multi-line mode is automatically entered whenever the first line of input
is not syntactically valid on its own.  Multi-line mode is then exited when
enter (or return) is pressed when the cursor is in the first column.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="kc">True</span><span class="p">:</span><span class="gp"></span>
<span class="gp">...</span>     <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="gp"></span>
<span class="gp">...</span> <span class="k">else</span><span class="p">:</span><span class="gp"></span>
<span class="gp">...</span>     <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="gp"></span>
<span class="gp">...</span><span class="go"></span>
<span class="go">1</span>
</pre></div>
</div>
<p>Flow control, of course, includes loops.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s1">&#39;xonsh&#39;</span><span class="p">):</span><span class="gp"></span>
<span class="gp">...</span>     <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="gp"></span>
<span class="gp">...</span><span class="go"></span>
<span class="go">0 x</span>
<span class="go">1 o</span>
<span class="go">2 n</span>
<span class="go">3 s</span>
<span class="go">4 h</span>
</pre></div>
</div>
<p>We can also define and call functions and classes. I’ll mostly spare you the
details, but this <em>is</em> pretty cool:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span><span class="gp"></span>
<span class="gp">...</span>     <span class="k">return</span> <span class="s2">&quot;xonsh&quot;</span><span class="gp"></span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">()</span><span class="go"></span>
<span class="go">&#39;xonsh&#39;</span>
</pre></div>
</div>
<p>For easier indentation, Shift+Tab will enter 4 spaces.
And that about wraps it up for the basics section.  It is just like Python.</p>
</section>
<section id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Environment variables are written as <code class="docutils literal notranslate"><span class="pre">$</span></code> followed by a name.  For example,
<code class="docutils literal notranslate"><span class="pre">$HOME</span></code>, <code class="docutils literal notranslate"><span class="pre">$PWD</span></code>, and <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nv">$HOME</span><span class="go"></span>
<span class="go">&#39;/home/snail&#39;</span>
</pre></div>
</div>
<p>You can set (and export) environment variables like you would set any other
variable in Python.  The same is true for deleting them too.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nv">$GOAL</span> <span class="o">=</span> <span class="s1">&#39;Become the Lord of the Files&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nv">$GOAL</span><span class="p">)</span><span class="go"></span>
<span class="go">Become the Lord of the Files</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="nv">$GOAL</span><span class="go"></span>
</pre></div>
</div>
<p>Very nice.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To update <code class="docutils literal notranslate"><span class="pre">os.environ</span></code> when the xonsh environment changes set
<a class="reference internal" href="envvars.html#update-os-environ"><span class="std std-ref">$UPDATE_OS_ENVIRON</span></a> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
<section id="the-environment-itself">
<h3>The Environment Itself <code class="docutils literal notranslate"><span class="pre">${...}</span></code><a class="headerlink" href="#the-environment-itself" title="Permalink to this headline">¶</a></h3>
<p>All environment variables live in the built-in <code class="docutils literal notranslate"><span class="pre">${...}</span></code> (aka <code class="docutils literal notranslate"><span class="pre">__xonsh__.env</span></code>) mapping.
You can access this mapping directly, but in most situations, you shouldn’t need to.</p>
<p>If you want for example to check if an environment variable is present in your current
session (say, in your awesome new <code class="docutils literal notranslate"><span class="pre">xonsh</span></code> script) you can use the membership operator:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;HOME&#39;</span> <span class="ow">in</span> <span class="k">$</span><span class="p">{</span><span class="o">...</span><span class="p">}</span><span class="go"></span>
<span class="go">True</span>
</pre></div>
</div>
<p>To get information about a specific environment variable you can use the
<a class="reference internal" href="api/environ.html#xonsh.environ.Env.help" title="xonsh.environ.Env.help"><code class="xref py py-func docutils literal notranslate"><span class="pre">help()</span></code></a> method.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">$</span><span class="p">{</span><span class="o">...</span><span class="p">}</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="s1">&#39;XONSH_DEBUG&#39;</span><span class="p">)</span><span class="go"></span>
</pre></div>
</div>
<p>One helpful method on the <code class="docutils literal notranslate"><span class="pre">${...}</span></code> is <a class="reference internal" href="api/environ.html#xonsh.environ.Env.swap" title="xonsh.environ.Env.swap"><code class="xref py py-func docutils literal notranslate"><span class="pre">swap()</span></code></a>.
It can be used to temporarily set an environment variable:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="k">$</span><span class="p">{</span><span class="o">...</span><span class="p">}</span><span class="o">.</span><span class="n">swap</span><span class="p">(</span><span class="n">SOMEVAR</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">):</span><span class="gp"></span>
<span class="gp">...</span>     <span class="n">echo</span> <span class="nv">$SOMEVAR</span><span class="gp"></span>
<span class="gp">...</span>
<span class="gp">...</span><span class="go"></span>
<span class="go">foo</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="nv">$SOMEVAR</span><span class="go"></span>

<span class="gp">&gt;&gt;&gt;</span><span class="go"></span>
</pre></div>
</div>
</section>
<section id="environment-lookup-with-expr">
<h3>Environment Lookup with <code class="docutils literal notranslate"><span class="pre">${&lt;expr&gt;}</span></code><a class="headerlink" href="#environment-lookup-with-expr" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">$NAME</span></code> is great as long as you know the name of the environment
variable you want to look up.  But what if you want to construct the name
programmatically, or read it from another variable?  Enter the <code class="docutils literal notranslate"><span class="pre">${}</span></code>
operator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In Bash, <code class="docutils literal notranslate"><span class="pre">$NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">${NAME}</span></code> are syntactically equivalent.
In xonsh, they have separate meanings.</p>
</div>
<p>We can place any valid Python expression inside of the curly braces in
<code class="docutils literal notranslate"><span class="pre">${&lt;expr&gt;}</span></code>. This result of this expression will then be used to look up a
value in the environment. Here are a couple of examples in action:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;USER&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">$</span><span class="p">{</span><span class="n">x</span><span class="p">}</span><span class="go"></span>
<span class="go">&#39;snail&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">$</span><span class="p">{</span><span class="s1">&#39;HO&#39;</span> <span class="o">+</span> <span class="s1">&#39;ME&#39;</span><span class="p">}</span><span class="go"></span>
<span class="go">&#39;/home/snail&#39;</span>
</pre></div>
</div>
<p>Not bad, xonsh, not bad.</p>
</section>
<section id="environment-types">
<h3>Environment Types<a class="headerlink" href="#environment-types" title="Permalink to this headline">¶</a></h3>
<p>Like other variables in Python, environment variables have a type. Sometimes
this type is imposed based on the variable name. The current rules are pretty
simple:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">\w*PATH</span></code>: any variable whose name ends in PATH is a list of strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">\w*DIRS</span></code>: any variable whose name ends in DIRS is a list of strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XONSH_HISTORY_SIZE</span></code>: this variable is an int.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CASE_SENSITIVE_COMPLETIONS</span></code>: this variable is a boolean.</p></li>
</ul>
<p>xonsh will automatically convert back and forth to untyped (string-only)
representations of the environment as needed (mostly by subprocess commands).
When in xonsh, you’ll always have the typed version.  Here are a couple of
PATH examples:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nv">$PATH</span><span class="go"></span>
<span class="go">[&#39;/home/snail/.local/bin&#39;, &#39;/home/snail/sandbox/bin&#39;,</span>
<span class="go">&#39;/home/snail/miniconda3/bin&#39;, &#39;/usr/local/bin&#39;, &#39;/usr/local/sbin&#39;,</span>
<span class="go">&#39;/usr/bin&#39;, &#39;/usr/sbin&#39;, &#39;/bin&#39;, &#39;/sbin&#39;, &#39;.&#39;]</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nv">$LD_LIBRARY_PATH</span><span class="go"></span>
<span class="go">[&#39;/home/snail/.local/lib&#39;, &#39;&#39;]</span>
</pre></div>
</div>
<p>Also note that <em>any</em> Python object can go into the environment. It is sometimes
useful to have more sophisticated types, like functions, in the environment.
There are handful of environment variables that xonsh considers special.
They can be seen on the <a class="reference external" href="envvars.html">Environment Variables page</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In subprocess mode, referencing an undefined environment variable
will produce an empty string.  In Python mode, however, a
<code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will be raised if the variable does not exist in the
environment.</p>
</div>
</section>
</section>
<section id="running-commands">
<h2>Running Commands<a class="headerlink" href="#running-commands" title="Permalink to this headline">¶</a></h2>
<p>As a shell, xonsh is meant to make running commands easy and fun.
Running subprocess commands should work like in any other shell.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">echo</span> <span class="s2">&quot;Yoo hoo&quot;</span><span class="go"></span>
<span class="go">Yoo hoo</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">cd</span> <span class="n">xonsh</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span><span class="go"></span>
<span class="go">build  docs     README.rst  setup.py  xonsh           __pycache__</span>
<span class="go">dist   license  scripts     tests     xonsh.egg-info</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">dir</span> <span class="n">scripts</span><span class="go"></span>
<span class="go">xonsh  xonsh.bat</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">status</span><span class="go"></span>
<span class="go">On branch main</span>
<span class="go">Your branch is up-to-date with &#39;origin/main&#39;.</span>
<span class="go">Changes not staged for commit:</span>
<span class="go">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span>
<span class="go">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span>

<span class="go">    modified:   docs/tutorial.rst</span>

<span class="go">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">exit</span><span class="go"></span>
</pre></div>
</div>
<p>This should feel very natural.</p>
</section>
<section id="python-mode-vs-subprocess-mode">
<h2>Python-mode vs Subprocess-mode<a class="headerlink" href="#python-mode-vs-subprocess-mode" title="Permalink to this headline">¶</a></h2>
<p>It is sometimes helpful to make the distinction between lines that operate
in pure Python mode and lines that use shell-specific syntax, edit the
execution environment, and run commands. Unfortunately, it is not always
clear from the syntax alone what mode is desired. This ambiguity stems from
most command line utilities looking a lot like Python operators.</p>
<p>Take the case of <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code>.  This is valid Python code, though it could
have also been written as <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-</span> <span class="pre">l</span></code> or <code class="docutils literal notranslate"><span class="pre">ls-l</span></code>.  So how does xonsh know
that <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code> is meant to be run in subprocess-mode?</p>
<p>For any given line that only contains an expression statement (expr-stmt,
see the Python AST docs for more information), if all the names cannot
be found as current variables xonsh will try to parse the line as a
subprocess command instead.  In the above, if <code class="docutils literal notranslate"><span class="pre">ls</span></code> and <code class="docutils literal notranslate"><span class="pre">l</span></code> are not
variables, then subprocess mode will be attempted. If parsing in subprocess
mode fails, then the line is left in Python-mode.</p>
<p>In the following example, we will list the contents of the directory
with <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code>. Then we’ll make new variable names <code class="docutils literal notranslate"><span class="pre">ls</span></code> and <code class="docutils literal notranslate"><span class="pre">l</span></code> and then
subtract them. Finally, we will delete <code class="docutils literal notranslate"><span class="pre">ls</span></code> and <code class="docutils literal notranslate"><span class="pre">l</span></code> and be able to list
the directories again.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># this will be in subproc-mode, because ls doesn&#39;t exist</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span><span class="go"></span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># set ls and l variables to force python-mode</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">=</span> <span class="mi">44</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">2</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span><span class="go"></span>
<span class="go">42</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># deleting ls will return us to subproc-mode</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">ls</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span><span class="go"></span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span>
</pre></div>
</div>
<p>The determination between Python- and subprocess-modes is always done in the
safest possible way. If anything goes wrong, it will favor Python-mode.
The determination between the two modes is done well ahead of any execution.
You do not need to worry about partially executed commands - that is
impossible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you would like to explicitly run a subprocess command, you can always
use the formal xonsh subprocess syntax that we will see in the following
sections. For example: <code class="docutils literal notranslate"><span class="pre">![ls</span> <span class="pre">-l]</span></code>.</p>
</div>
</section>
<section id="quoting">
<h2>Quoting<a class="headerlink" href="#quoting" title="Permalink to this headline">¶</a></h2>
<p>Single or double quotes can be used to remove the special meaning
of certain characters or words to xonsh. If a subprocess command
contains characters that collide with xonsh syntax then quotes
must be used to force xonsh to not interpret them.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">echo</span> <span class="k">$</span><span class="p">{</span><span class="gp"></span>
<span class="gp">...</span><span class="go"></span>
<span class="go">SyntaxError: &lt;xonsh-code&gt;:1:5: (&#39;code: {&#39;,)</span>
<span class="go">echo ${</span>
<span class="go">     ^</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="s1">&#39;${&#39;</span><span class="go"></span>
<span class="go">${</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is no notion of an escaping character in xonsh like the
backslash (\) in bash.</p>
</div>
</section>
<section id="captured-subprocess-with-and">
<h2>Captured Subprocess with <code class="docutils literal notranslate"><span class="pre">$()</span></code> and <code class="docutils literal notranslate"><span class="pre">!()</span></code><a class="headerlink" href="#captured-subprocess-with-and" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">$(&lt;expr&gt;)</span></code> operator in xonsh executes a subprocess command and
<em>captures</em> some information about that command.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">$()</span></code> syntax captures and returns the standard output stream of the
command as a Python string.  This is similar to how <code class="docutils literal notranslate"><span class="pre">$()</span></code> performs in Bash.
For example,</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">$</span><span class="p">(</span><span class="nb">ls</span> -l<span class="p">)</span><span class="go"></span>
<span class="go">&#39;total 0\n-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh\n&#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">!()</span></code> syntax captured more information about the command, as an instance
of a class called <code class="docutils literal notranslate"><span class="pre">CommandPipeline</span></code>.  This object contains more information
about the result of the given command, including the return code, the process
id, the standard output and standard error streams, and information about how
input and output were redirected.  For example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">!</span><span class="p">(</span><span class="nb">ls</span> nonexistent_directory<span class="p">)</span><span class="go"></span>
<span class="go">CommandPipeline(</span>
<span class="go">    stdin=&lt;_io.BytesIO object at 0x7f1948182bf8&gt;,</span>
<span class="go">    stdout=&lt;_io.BytesIO object at 0x7f1948182af0&gt;,</span>
<span class="go">    stderr=&lt;_io.BytesIO object at 0x7f19483a6200&gt;,</span>
<span class="go">    pid=26968,</span>
<span class="go">    returncode=2,</span>
<span class="go">    args=[&#39;ls&#39;, &#39;nonexistent_directory&#39;],</span>
<span class="go">    alias=[&#39;ls&#39;, &#39;--color=auto&#39;, &#39;-v&#39;],</span>
<span class="go">    stdin_redirect=[&#39;&lt;stdin&gt;&#39;, &#39;r&#39;],</span>
<span class="go">    stdout_redirect=[9, &#39;wb&#39;],</span>
<span class="go">    stderr_redirect=[11, &#39;w&#39;],</span>
<span class="go">    timestamps=[1485235484.5016758, None],</span>
<span class="go">    executed_cmd=[&#39;ls&#39;, &#39;--color=auto&#39;, &#39;-v&#39;, &#39;nonexistent_directory&#39;],</span>
<span class="go">    input=None,</span>
<span class="go">    output=,</span>
<span class="go">    errors=None</span>
<span class="go">)</span>
</pre></div>
</div>
<p>This object will be “truthy” if its return code was 0, and it is equal (via
<code class="docutils literal notranslate"><span class="pre">==</span></code>) to its return code. It also hashes to its return code. Converting the object
to the string will return the output. This allows for some interesting new
kinds of interactions with subprocess commands, for example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_file</span><span class="p">(</span><span class="n">file</span><span class="p">):</span><span class="go"></span>
<span class="go">    if !(test -e @(file)):</span>
<span class="go">        if !(test -f @(file)) or !(test -d @(file)):</span>
<span class="go">            print(&quot;File is a regular file or directory&quot;)</span>
<span class="go">        else:</span>
<span class="go">            print(&quot;File is not a regular file or directory&quot;)</span>
<span class="go">    else:</span>
<span class="go">        print(&quot;File does not exist&quot;)</span>

<span class="go">def wait_until_google_responds():</span>
<span class="go">    while not !(ping -c 1 google.com):</span>
<span class="go">        sleep 1</span>
</pre></div>
</div>
<p>If you iterate over the <code class="docutils literal notranslate"><span class="pre">CommandPipeline</span></code> object, it will yield lines of its
output.  Using this, you can quickly and cleanly process output from commands.
Additionally, these objects expose a method <code class="docutils literal notranslate"><span class="pre">itercheck</span></code>, which behaves the same
as the built-in iterator but raises <code class="docutils literal notranslate"><span class="pre">XonshCalledProcessError</span></code> if the process
had a nonzero return code.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_wireless_interface</span><span class="p">():</span><span class="go"></span>
<span class="go">    &quot;&quot;&quot;Returns devicename of first connected wifi, None otherwise&quot;&quot;&quot;</span>
<span class="go">    for line in !(nmcli device):</span>
<span class="go">        dev, typ, state, conn_name = line.split(None, 3)</span>
<span class="go">        if typ == &#39;wifi&#39; and state == &#39;connected&#39;:</span>
<span class="go">            return dev</span>

<span class="go">def grep_path(path, regexp):</span>
<span class="go">    &quot;&quot;&quot;Recursively greps `path` for perl `regexp`</span>

<span class="go">    Returns a dict of &#39;matches&#39; and &#39;failures&#39;.</span>
<span class="go">    Matches are files that contain the given regexp.</span>
<span class="go">    Failures are files that couldn&#39;t be scanned.</span>
<span class="go">    &quot;&quot;&quot;</span>
<span class="go">    matches = []</span>
<span class="go">    failures = []</span>

<span class="go">    try:</span>
<span class="go">        for match in !(grep -RPl @(regexp) @(str(path))).itercheck():</span>
<span class="go">            matches.append(match)</span>
<span class="go">    except XonshCalledProcessError as error:</span>
<span class="go">        for line in error.stderr.split(&#39;\n&#39;):</span>
<span class="go">            if not line.strip():</span>
<span class="go">                continue</span>
<span class="go">            filename = line.split(&#39;grep: &#39;, 1)[1].rsplit(&#39;:&#39;, 1)[0]</span>
<span class="go">            failures.append(filename)</span>
<span class="go">    return {&#39;matches&#39;: matches, &#39;failures&#39;: failures}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">$()</span></code> and <code class="docutils literal notranslate"><span class="pre">!()</span></code> operators are expressions themselves. This means that
we can assign the results to a variable or perform any other manipulations we
want.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="k">$</span><span class="p">(</span><span class="nb">ls</span> -l<span class="p">)</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span><span class="go"></span>
<span class="go">TOTAL 0</span>
<span class="go">-RW-RW-R-- 1 SNAIL SNAIL 0 MAR  8 15:46 XONSH</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="k">!</span><span class="p">(</span><span class="nb">ls</span> -l<span class="p">)</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">returncode</span><span class="p">)</span><span class="go"></span>
<span class="go">0</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">rtn</span><span class="p">)</span>  <span class="c1"># alias to returncode</span><span class="go"></span>
<span class="go">0</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Job control is not implemented for captured subprocesses.</p>
</div>
<p>While in subprocess-mode or inside of a captured subprocess, we can always
still query the environment with <code class="docutils literal notranslate"><span class="pre">$NAME</span></code> variables or the <code class="docutils literal notranslate"><span class="pre">${}</span></code> syntax,
or inject Python values with the <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> operator:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">$</span><span class="p">(</span><span class="nb">echo</span> <span class="nv">$HOME</span><span class="p">)</span><span class="go"></span>
<span class="go">&#39;/home/snail\n&#39;</span>
</pre></div>
</div>
</section>
<section id="uncaptured-subprocess-with-and">
<h2>Uncaptured Subprocess with <code class="docutils literal notranslate"><span class="pre">$[]</span></code> and <code class="docutils literal notranslate"><span class="pre">![]</span></code><a class="headerlink" href="#uncaptured-subprocess-with-and" title="Permalink to this headline">¶</a></h2>
<p>Uncaptured subprocesses are denoted with the <code class="docutils literal notranslate"><span class="pre">$[]</span></code> and <code class="docutils literal notranslate"><span class="pre">![]</span></code> operators. They are
the same as <code class="docutils literal notranslate"><span class="pre">$()</span></code> captured subprocesses in almost every way. The only
difference is that the subprocess’s stdout passes directly through xonsh and
to the screen.  The return value of <code class="docutils literal notranslate"><span class="pre">$[]</span></code> is always <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>In the following, we can see that the results of <code class="docutils literal notranslate"><span class="pre">$[]</span></code> are automatically
printed, and that the return value is not a string.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="k">$</span><span class="p">[</span><span class="nb">ls</span> -l<span class="p">]</span><span class="go"></span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="go"></span>
<span class="go">True</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">![]</span></code> operator is similar to the <code class="docutils literal notranslate"><span class="pre">!()</span></code> in that it returns an object
containing information about the result of executing the given command.
However, its standard output and standard error streams are directed to the
terminal, and the resulting object is not displayed.  For example</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="k">!</span><span class="p">[</span><span class="nb">ls</span> -l<span class="p">]</span> <span class="ow">and</span> <span class="k">!</span><span class="p">[</span><span class="nb">echo</span> <span class="s2">&quot;hi&quot;</span><span class="p">]</span><span class="go"></span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span>
<span class="go">hi</span>
</pre></div>
</div>
</section>
<section id="python-evaluation-with">
<h2>Python Evaluation with <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code><a class="headerlink" href="#python-evaluation-with" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;(&lt;expr&gt;)</span></code> operator form works in subprocess mode, and will evaluate
arbitrary Python code. The result is appended to the subprocess command list.
If the result is a string or bytes, it is appended to the argument list. If the result
is a list or other non-string sequence, the contents are converted to strings
and appended to the argument list in order. If the result in the first position
is a function, it is treated as an alias (see the section on <a class="reference internal" href="#aliases">Aliases</a> below),
even if it was not explicitly added to the <code class="docutils literal notranslate"><span class="pre">aliases</span></code> mapping.  Otherwise, the
result is automatically converted to a string. For example,</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;xonsh&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;party&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="k">@</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="go"></span>
<span class="go">xonsh party</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="k">@</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="go"></span>
<span class="go">4</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="k">@</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;yo&#39;</span><span class="p">])</span><span class="go"></span>
<span class="go">42 yo</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="s2">&quot;hello&quot;</span> <span class="o">|</span> <span class="k">@</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; world</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="go"></span>
<span class="go">hello world</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">@</span><span class="p">([</span><span class="s1">&#39;echo&#39;</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">])</span><span class="go"></span>
<span class="go">hello world</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">@</span><span class="p">(</span><span class="s1">&#39;echo hello world&#39;</span><span class="p">)</span>  <span class="c1"># note that strings are not split automatically</span><span class="go"></span>
<span class="go">xonsh: subprocess mode: command not found: echo hello world</span>
</pre></div>
</div>
<p>This syntax can be used inside of a captured or uncaptured subprocess, and can
be used to generate any of the tokens in the subprocess command list.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="k">$</span><span class="p">(</span><span class="nb">echo</span> <span class="k">@</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">out</span><span class="go"></span>
<span class="go">&#39;xonsh party\n&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">@</span><span class="p">(</span><span class="s2">&quot;ech&quot;</span> <span class="o">+</span> <span class="s2">&quot;o&quot;</span><span class="p">)</span> <span class="s2">&quot;hey&quot;</span><span class="go"></span>
<span class="go">hey</span>
</pre></div>
</div>
<p>Thus, <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> allows us to create complex commands in Python-mode and then
feed them to a subprocess as needed.  For example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span><span class="go"></span>
<span class="go">    $[touch @(&#39;file%02d&#39; % i)]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> syntax may also be used inside of subprocess
arguments, not just as a stand-alone argument. For example:</p>
<blockquote>
<div><div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="k">@</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="go"></span>
<span class="go">/path/to/hello</span>
</pre></div>
</div>
</div></blockquote>
<p>When used inside of a subprocess argument and <code class="docutils literal notranslate"><span class="pre">&lt;expr&gt;</span></code> evaluates to a
non-string iterable, <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> will expand to the outer product of all
given values:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; <span class="nb">echo</span> /path/to/@<span class="o">([</span><span class="s1">&#39;hello&#39;</span>, <span class="s1">&#39;world&#39;</span><span class="o">])</span>
/path/to/hello /path/to/world

&gt;&gt;&gt; <span class="nb">echo</span> @<span class="o">([</span><span class="s1">&#39;a&#39;</span>, <span class="s1">&#39;b&#39;</span><span class="o">])</span>:@<span class="o">(</span><span class="s1">&#39;x&#39;</span>, <span class="s1">&#39;y&#39;</span><span class="o">)</span>
a:x a:y b:x b:y
</pre></div>
</div>
</div></blockquote>
</section>
<section id="command-substitution-with">
<h2>Command Substitution with <code class="docutils literal notranslate"><span class="pre">&#64;$()</span></code><a class="headerlink" href="#command-substitution-with" title="Permalink to this headline">¶</a></h2>
<p>A common use of the <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> and <code class="docutils literal notranslate"><span class="pre">$()</span></code> operators is allowing the output of a
command to replace the command itself (command substitution):
<code class="docutils literal notranslate"><span class="pre">&#64;([i.strip()</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">$(cmd).split()])</span></code>.  Xonsh offers a
short-hand syntax for this operation: <code class="docutils literal notranslate"><span class="pre">&#64;$(cmd)</span></code>.</p>
<p>Consider the following example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># this returns a string representing stdout</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">$</span><span class="p">(</span><span class="nb">which</span> ls<span class="p">)</span><span class="go"></span>
<span class="go">&#39;ls --color=auto\n&#39;</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># this attempts to run the command, but as one argument</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># (looks for &#39;ls --color=auto\n&#39; with spaces and newline)</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">@</span><span class="p">(</span><span class="k">$</span><span class="p">(</span><span class="nb">which</span> ls<span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="go"></span>
<span class="go">xonsh: subprocess mode: command not found: ls --color=auto</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># this actually executes the intended command</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">@</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="k">$</span><span class="p">(</span><span class="nb">which</span> ls<span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span><span class="go"></span>
<span class="go">some_file  some_other_file</span>

<span class="gp">&gt;&gt;&gt;</span> <span class="c1"># this does the same thing, but is much more concise</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">@$</span><span class="p">(</span><span class="nb">which</span> ls<span class="p">)</span><span class="go"></span>
<span class="go">some_file  some_other_file</span>
</pre></div>
</div>
</section>
<section id="nesting-subprocesses">
<h2>Nesting Subprocesses<a class="headerlink" href="#nesting-subprocesses" title="Permalink to this headline">¶</a></h2>
<p>Though I am begging you not to abuse this, it is possible to nest the
subprocess operators that we have seen so far (<code class="docutils literal notranslate"><span class="pre">$()</span></code>, <code class="docutils literal notranslate"><span class="pre">$[]</span></code>, <code class="docutils literal notranslate"><span class="pre">${}</span></code>,
<code class="docutils literal notranslate"><span class="pre">&#64;()</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;$()</span></code>).  An instance of <code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">-l</span></code> that is on the wrong side of the
border of the absurd is shown below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; $[@$(which @($(echo ls).strip())) @(&#39;-&#39; + $(printf &#39;l&#39;))]</span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span>
</pre></div>
</div>
<p>With great power, and so forth…</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Nesting these subprocess operators inside of <code class="docutils literal notranslate"><span class="pre">$()</span></code> and/or <code class="docutils literal notranslate"><span class="pre">$[]</span></code>
works because the contents of those operators are executed in
subprocess mode.  Since <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> and <code class="docutils literal notranslate"><span class="pre">${}</span></code> run their contents in
Python mode, it is not possible to nest other subprocess operators
inside of them.</p>
</div>
<p>To understand how xonsh executes the subprocess commands try
to set <a class="reference internal" href="envvars.html#xonsh-trace-subproc"><span class="std std-ref">$XONSH_TRACE_SUBPROC</span></a> to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt; $XONSH_TRACE_SUBPROC = True</span>
<span class="go">&gt;&gt;&gt; $[@$(which @($(echo ls).strip())) @(&#39;-&#39; + $(printf &#39;l&#39;))]</span>
<span class="go">TRACE SUBPROC: ([&#39;echo&#39;, &#39;ls&#39;],)</span>
<span class="go">TRACE SUBPROC: ([&#39;which&#39;, &#39;ls&#39;],)</span>
<span class="go">TRACE SUBPROC: ([&#39;printf&#39;, &#39;l&#39;],)</span>
<span class="go">TRACE SUBPROC: ([&#39;ls&#39;, &#39;--color=auto&#39;, &#39;-v&#39;, &#39;-l&#39;],)</span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span>
</pre></div>
</div>
</section>
<section id="pipes">
<h2>Pipes<a class="headerlink" href="#pipes" title="Permalink to this headline">¶</a></h2>
<p>In subprocess-mode, xonsh allows you to use the <code class="docutils literal notranslate"><span class="pre">|</span></code> character to pipe
together commands as you would in other shells.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">|</span> <span class="n">uniq</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">PATH</span><span class="go"></span>
<span class="go">DATAPATH=/usr/share/MCNPX/v260/Data/</span>
<span class="go">DEFAULTS_PATH=/usr/share/gconf/awesome-gnome.default.path</span>
<span class="go">LD_LIBRARY_PATH=/home/snail/.local/lib:</span>
<span class="go">MANDATORY_PATH=/usr/share/gconf/awesome-gnome.mandatory.path</span>
<span class="go">PATH=/home/snail/.local/bin:/home/snail/sandbox/bin:/usr/local/bin</span>
<span class="go">XDG_SEAT_PATH=/org/freedesktop/DisplayManager/Seat0</span>
<span class="go">XDG_SESSION_PATH=/org/freedesktop/DisplayManager/Session0</span>
</pre></div>
</div>
<p>This is only available in subprocess-mode because <code class="docutils literal notranslate"><span class="pre">|</span></code> is otherwise a
Python operator.
If you are unsure of what pipes are, there are many great references out there.
You should be able to find information on StackOverflow or Google.</p>
</section>
<section id="logical-subprocess-and">
<h2>Logical Subprocess And<a class="headerlink" href="#logical-subprocess-and" title="Permalink to this headline">¶</a></h2>
<p>Subprocess-mode also allows you to use the <code class="docutils literal notranslate"><span class="pre">and</span></code> operator to chain together
subprocess commands. The truth value of a command is evaluated as whether
its return code is zero (i.e. <code class="docutils literal notranslate"><span class="pre">proc.returncode</span> <span class="pre">==</span> <span class="pre">0</span></code>).  Like in Python,
if the command evaluates to <code class="docutils literal notranslate"><span class="pre">False</span></code>, subsequent commands will not be executed.
For example, suppose we want to lists files that may or may not exist:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">touch</span> <span class="n">exists</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="n">exists</span> <span class="ow">and</span> <span class="n">ls</span> <span class="n">doesnt</span><span class="go"></span>
<span class="go">exists</span>
<span class="go">/bin/ls: cannot access doesnt: No such file or directory</span>
</pre></div>
</div>
<p>However, if you list the file that doesn’t exist first,
you would have only seen the error:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="n">doesnt</span> <span class="ow">and</span> <span class="n">ls</span> <span class="n">exists</span><span class="go"></span>
<span class="go">/bin/ls: cannot access doesnt: No such file or directory</span>
</pre></div>
</div>
<p>Also, don’t worry. Xonsh directly translates the <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> operator into <code class="docutils literal notranslate"><span class="pre">and</span></code>
for you. It is less Pythonic, of course, but it is your shell!</p>
</section>
<section id="logical-subprocess-or">
<h2>Logical Subprocess Or<a class="headerlink" href="#logical-subprocess-or" title="Permalink to this headline">¶</a></h2>
<p>Much like with <code class="docutils literal notranslate"><span class="pre">and</span></code>, you can use the <code class="docutils literal notranslate"><span class="pre">or</span></code> operator to chain together
subprocess commands. The difference, to be certain, is that
subsequent commands will be executed only if the
if the return code is non-zero (i.e. a failure). Using the file example
from above:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="n">exists</span> <span class="ow">or</span> <span class="n">ls</span> <span class="n">doesnt</span><span class="go"></span>
<span class="go">exists</span>
</pre></div>
</div>
<p>This doesn’t even try to list a non-existent file!
However, if you list the file that doesn’t exist first,
you will see the error and then the file that does exist:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="n">doesnt</span> <span class="ow">or</span> <span class="n">ls</span> <span class="n">exists</span><span class="go"></span>
<span class="go">/bin/ls: cannot access doesnt: No such file or directory</span>
<span class="go">exists</span>
</pre></div>
</div>
<p>Never fear! Xonsh also directly translates the <code class="docutils literal notranslate"><span class="pre">||</span></code> operator into <code class="docutils literal notranslate"><span class="pre">or</span></code>,
too. Your muscle memory is safe now, here with us.</p>
</section>
<section id="input-output-redirection">
<h2>Input/Output Redirection<a class="headerlink" href="#input-output-redirection" title="Permalink to this headline">¶</a></h2>
<p>xonsh also allows you to redirect <code class="docutils literal notranslate"><span class="pre">stdin</span></code>, <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, and/or <code class="docutils literal notranslate"><span class="pre">stderr</span></code>.
This allows you to control where the output of a command is sent, and where
it receives its input from.  xonsh has its own syntax for these operations,
but, for compatibility purposes, xonsh also support Bash-like syntax.</p>
<p>The basic operations are “write to” (<code class="docutils literal notranslate"><span class="pre">&gt;</span></code>), “append to” (<code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>), and “read
from” (<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>).  The details of these are perhaps best explained through
examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The target of the redirection should be separated by a space,
otherwise xonsh will raise a SyntaxError.</p>
</div>
<section id="redirecting-stdout">
<h3>Redirecting <code class="docutils literal notranslate"><span class="pre">stdout</span></code><a class="headerlink" href="#redirecting-stdout" title="Permalink to this headline">¶</a></h3>
<p>All of the following examples will execute <code class="docutils literal notranslate"><span class="pre">COMMAND</span></code> and write its regular
output (stdout) to a file called <code class="docutils literal notranslate"><span class="pre">output.txt</span></code>, creating it if it does not
exist:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">out</span><span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">o</span><span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">txt</span> <span class="c1"># included for Bash compatibility</span><span class="go"></span>
</pre></div>
</div>
<p>These can be made to append to <code class="docutils literal notranslate"><span class="pre">output.txt</span></code> instead of overwriting its contents
by replacing <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> with <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> (note that <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> will still create the file if it
does not exist).</p>
</section>
<section id="redirecting-stderr">
<h3>Redirecting <code class="docutils literal notranslate"><span class="pre">stderr</span></code><a class="headerlink" href="#redirecting-stderr" title="Permalink to this headline">¶</a></h3>
<p>All of the following examples will execute <code class="docutils literal notranslate"><span class="pre">COMMAND</span></code> and write its error
output (stderr) to a file called <code class="docutils literal notranslate"><span class="pre">errors.txt</span></code>, creating it if it does not
exist:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="n">err</span><span class="o">&gt;</span> <span class="n">errors</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">e</span><span class="o">&gt;</span> <span class="n">errors</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">errors</span><span class="o">.</span><span class="n">txt</span> <span class="c1"># included for Bash compatibility</span><span class="go"></span>
</pre></div>
</div>
<p>As above, replacing <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> with <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> will cause the error output to be
appended to <code class="docutils literal notranslate"><span class="pre">errors.txt</span></code>, rather than replacing its contents.</p>
</section>
<section id="combining-streams">
<h3>Combining Streams<a class="headerlink" href="#combining-streams" title="Permalink to this headline">¶</a></h3>
<p>It is possible to send all of <code class="docutils literal notranslate"><span class="pre">COMMAND</span></code>’s output (both regular output and
error output) to the same location.  All of the following examples accomplish
that task:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="nb">all</span><span class="o">&gt;</span> <span class="n">combined</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">a</span><span class="o">&gt;</span> <span class="n">combined</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="o">&amp;&gt;</span> <span class="n">combined</span><span class="o">.</span><span class="n">txt</span> <span class="c1"># included for Bash compatibility</span><span class="go"></span>
</pre></div>
</div>
<p>It is also possible to explicitly merge stderr into stdout so that error
messages are reported to the same location as regular output.  You can do this
with the following syntax:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">out</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">o</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">e</span><span class="o">&gt;</span><span class="n">out</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">e</span><span class="o">&gt;</span><span class="n">o</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>  <span class="c1"># included for Bash compatibility</span><span class="go"></span>
</pre></div>
</div>
<p>This merge can be combined with other redirections, including pipes (see the
section on <a class="reference internal" href="#pipes">Pipes</a> above):</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">out</span> <span class="o">|</span> <span class="n">COMMAND2</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">e</span><span class="o">&gt;</span><span class="n">o</span> <span class="o">&gt;</span> <span class="n">combined</span><span class="o">.</span><span class="n">txt</span><span class="go"></span>
</pre></div>
</div>
<p>It is worth noting that this last example is equivalent to: <code class="docutils literal notranslate"><span class="pre">COMMAND</span> <span class="pre">a&gt;</span> <span class="pre">combined.txt</span></code></p>
<p>Similarly, you can also send stdout to stderr with the following syntax:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="n">out</span><span class="o">&gt;</span><span class="n">err</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">out</span><span class="o">&gt;</span><span class="n">e</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">o</span><span class="o">&gt;</span><span class="n">err</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="n">o</span><span class="o">&gt;</span><span class="n">e</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">COMMAND</span> <span class="mi">1</span><span class="o">&gt;&amp;</span><span class="mi">2</span>  <span class="c1"># included for Bash compatibility</span><span class="go"></span>
</pre></div>
</div>
</section>
<section id="redirecting-stdin">
<h3>Redirecting <code class="docutils literal notranslate"><span class="pre">stdin</span></code><a class="headerlink" href="#redirecting-stdin" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to have a command read its input from a file, rather
than from <code class="docutils literal notranslate"><span class="pre">stdin</span></code>.  The following examples demonstrate two ways to accomplish this:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND</span> <span class="o">&lt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">txt</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="o">&lt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">txt</span> <span class="n">COMMAND</span><span class="go"></span>
</pre></div>
</div>
</section>
<section id="combining-i-o-redirects">
<h3>Combining I/O Redirects<a class="headerlink" href="#combining-i-o-redirects" title="Permalink to this headline">¶</a></h3>
<p>It is worth noting that all of these redirections can be combined.  Below is
one example of a complicated redirect.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">COMMAND1</span> <span class="n">e</span><span class="o">&gt;</span><span class="n">o</span> <span class="o">&lt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">txt</span> <span class="o">|</span> <span class="n">COMMAND2</span> <span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">txt</span> <span class="n">e</span><span class="o">&gt;&gt;</span> <span class="n">errors</span><span class="o">.</span><span class="n">txt</span><span class="go"></span>
</pre></div>
</div>
<p>This line will run <code class="docutils literal notranslate"><span class="pre">COMMAND1</span></code> with the contents of <code class="docutils literal notranslate"><span class="pre">input.txt</span></code> fed in on
stdin, and will pipe all output (stdout and stderr) to <code class="docutils literal notranslate"><span class="pre">COMMAND2</span></code>; the
regular output of this command will be redirected to <code class="docutils literal notranslate"><span class="pre">output.txt</span></code>, and the
error output will be appended to <code class="docutils literal notranslate"><span class="pre">errors.txt</span></code>.</p>
</section>
</section>
<section id="background-jobs">
<h2>Background Jobs<a class="headerlink" href="#background-jobs" title="Permalink to this headline">¶</a></h2>
<p>Typically, when you start a program running in xonsh, xonsh itself will pause
and wait for that program to terminate.  Sometimes, though, you may want to
continue giving commands to xonsh while that program is running.  In subprocess
mode, you can start a process “in the background” (i.e., in a way that allows
continued use of the shell) by adding an ampersand (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>) to the end of your
command.  Background jobs are very useful when running programs with graphical
user interfaces.</p>
<p>The following shows an example with <code class="docutils literal notranslate"><span class="pre">emacs</span></code>.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">emacs</span> <span class="o">&amp;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span><span class="go"></span>
</pre></div>
</div>
<p>Note that the prompt is returned to you after emacs is started.</p>
<p>Normally background commands end upon the shell closing. To allow a background
command to continue running after the shell has exited, use the <code class="docutils literal notranslate"><span class="pre">disown</span></code>
command which accepts either no arguments (to disown the most recent job)
or an arbitrary number of job identifiers.</p>
</section>
<section id="job-control">
<h2>Job Control<a class="headerlink" href="#job-control" title="Permalink to this headline">¶</a></h2>
<p>If you start a program in the foreground (with no ampersand), you can suspend
that program’s execution and return to the xonsh prompt by pressing Control-Z.
This will give control of the terminal back to xonsh, and will keep the program
paused in the background.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Suspending processes via Control-Z is not yet supported when
running on Windows.</p>
</div>
<p>To unpause the program and bring it back to the foreground, you can use the
<code class="docutils literal notranslate"><span class="pre">fg</span></code> command.  To unpause the program have it continue in the background
(giving you continued access to the xonsh prompt), you can use the <code class="docutils literal notranslate"><span class="pre">bg</span></code>
command.</p>
<p>You can get a listing of all currently running jobs with the <code class="docutils literal notranslate"><span class="pre">jobs</span></code> command.</p>
<p>Each job has a unique identifier (starting with 1 and counting upward).  By
default, the <code class="docutils literal notranslate"><span class="pre">fg</span></code> and <code class="docutils literal notranslate"><span class="pre">bg</span></code> commands operate on the job that was started
most recently.  You can bring older jobs to the foreground or background by
specifying the appropriate ID; for example, <code class="docutils literal notranslate"><span class="pre">fg</span> <span class="pre">1</span></code> brings the job with ID 1
to the foreground. Additionally, specify “+” for the most recent job and “-”
for the second most recent job.</p>
</section>
<section id="string-literals-in-subprocess-mode">
<h2>String Literals in Subprocess-mode<a class="headerlink" href="#string-literals-in-subprocess-mode" title="Permalink to this headline">¶</a></h2>
<p>Strings can be used to escape special characters in subprocess-mode. The
contents of the string are passed directly to the subprocess command as a
single argument.  So whenever you are in doubt, or if there is a xonsh syntax
error because of a filename, just wrap the offending portion in a string.</p>
<p>A common use case for this is files with spaces in their names. This
detestable practice refuses to die. “No problem!” says xonsh, “I have
strings.”  Let’s see it go!</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">touch</span> <span class="s2">&quot;sp ace&quot;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span><span class="go"></span>
<span class="go">total 0</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 17:50 sp ace</span>
<span class="go">-rw-rw-r-- 1 snail snail 0 Mar  8 15:46 xonsh</span>
</pre></div>
</div>
<p>By default, the name of an environment variable inside a string will be
replaced by the contents of that variable (in subprocess mode only).  For
example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;my home is $HOME&quot;</span><span class="p">)</span><span class="go"></span>
<span class="go">my home is $HOME</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="s2">&quot;my home is $HOME&quot;</span><span class="go"></span>
<span class="go">my home is /home/snail</span>
</pre></div>
</div>
<p>You can avoid this expansion within a particular command by forcing the strings
to be evaluated in Python mode using the <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> syntax:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">echo</span> <span class="s2">&quot;my home is $HOME&quot;</span><span class="go"></span>
<span class="go">my home is /home/snail</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="k">@</span><span class="p">(</span><span class="s2">&quot;my home is $HOME&quot;</span><span class="p">)</span><span class="go"></span>
<span class="go">my home is $HOME</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also disable environment variable expansion completely by setting
<code class="docutils literal notranslate"><span class="pre">$EXPAND_ENV_VARS</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
</section>
<section id="advanced-string-literals">
<h2>Advanced String Literals<a class="headerlink" href="#advanced-string-literals" title="Permalink to this headline">¶</a></h2>
<p>For the fine control of environment variables (envvar) substitutions, brace substitutions and backslash escapes
there are extended list of literals:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> - regular string: backslash escapes. Envvar substitutions in subprocess-mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r&quot;&quot;</span></code> - raw string: unmodified.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f&quot;&quot;</span></code> - formatted string: brace substitutions, backslash escapes. Envvar substitutions in subprocess-mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fr&quot;&quot;</span></code> - raw formatted string: brace substitutions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p&quot;&quot;</span></code> - path string: backslash escapes, envvar substitutions, returns Path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pr&quot;&quot;</span></code> - raw Path string: envvar substitutions, returns Path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pf&quot;&quot;</span></code> - formatted Path string: backslash escapes, brace and envvar substitutions, returns Path.</p></li>
</ul>
<p>To complete understanding let’s set environment variable <code class="docutils literal notranslate"><span class="pre">$EVAR</span></code> to <code class="docutils literal notranslate"><span class="pre">1</span></code> and local variable <code class="docutils literal notranslate"><span class="pre">var</span></code> to <code class="docutils literal notranslate"><span class="pre">2</span></code>
and make a table that shows how literal changes the string in Python- and subprocess-mode:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 28%" />
<col style="width: 24%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>String literal</p></th>
<th class="head"><p>As python object</p></th>
<th class="head"><p>print(&lt;String literal&gt;)</p></th>
<th class="head"><p>echo &lt;String literal&gt;</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;/$EVAR/'{var}'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/$EVAR/'{var}'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/'{var}'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;/$EVAR/\\'{var}\\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/$EVAR/\'{var}\'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/$EVAR/\'{var}\'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">f&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;/$EVAR/'2'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/$EVAR/'2'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/'2'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fr&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;/$EVAR/\\'2\\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/$EVAR/\'2\'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/$EVAR/\'2\'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">p&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Path(&quot;/1/'{var}'&quot;)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/'{var}'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/'{var}'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pr&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Path(&quot;/1/\\'{var}\\'&quot;)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/\'{var}\'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/\'{var}\'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pf&quot;/$EVAR/\'{var}\'&quot;</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Path(&quot;/1/'2'&quot;)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/'2'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">/1/'2'</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="filename-globbing-with">
<h2>Filename Globbing with <code class="docutils literal notranslate"><span class="pre">*</span></code><a class="headerlink" href="#filename-globbing-with" title="Permalink to this headline">¶</a></h2>
<p>Filename globbing with the <code class="docutils literal notranslate"><span class="pre">*</span></code> character is also allowed in subprocess-mode.
This simply uses Python’s glob module under-the-covers.  See there for more
details.  As an example, start with a lovely bunch of xonshs:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">touch</span> <span class="n">xonsh</span> <span class="n">conch</span> <span class="n">konk</span> <span class="n">quanxh</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span><span class="go"></span>
<span class="go">conch  konk  quanxh  xonsh</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">*</span><span class="n">h</span><span class="go"></span>
<span class="go">conch  quanxh  xonsh</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="o">*</span><span class="n">o</span><span class="o">*</span><span class="go"></span>
<span class="go">conch  konk  xonsh</span>
</pre></div>
</div>
<p>This is not available in Python-mode because multiplication is pretty
important.</p>
</section>
<section id="advanced-path-search-with-backticks">
<h2>Advanced Path Search with Backticks<a class="headerlink" href="#advanced-path-search-with-backticks" title="Permalink to this headline">¶</a></h2>
<p>xonsh offers additional ways to find path names beyond regular globbing, both
in Python mode and in subprocess mode.</p>
<section id="regular-expression-globbing">
<h3>Regular Expression Globbing<a class="headerlink" href="#regular-expression-globbing" title="Permalink to this headline">¶</a></h3>
<p>If you have ever felt that normal globbing could use some more octane,
then regex globbing is the tool for you! Any string that uses backticks
(<code class="docutils literal notranslate"><span class="pre">`</span></code>) instead of quotes (<code class="docutils literal notranslate"><span class="pre">'</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;</span></code>) is interpreted as a regular
expression to match filenames against.  Like with regular globbing, a
list of successful matches is returned.  In Python-mode, this is just a
list of strings. In subprocess-mode, each filename becomes its own argument
to the subprocess command.</p>
<p>Let’s see a demonstration with some simple filenames:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">touch</span> <span class="n">a</span> <span class="n">aa</span> <span class="n">aaa</span> <span class="n">aba</span> <span class="n">abba</span> <span class="n">aab</span> <span class="n">aabb</span> <span class="n">abcba</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="sb">`a(a</span><span class="sr">+|</span><span class="sb">b</span><span class="sr">+</span><span class="sb">)a`</span><span class="go"></span>
<span class="go">aaa  aba  abba</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="sb">`a(a</span><span class="sr">+|</span><span class="sb">b</span><span class="sr">+</span><span class="sb">)a`</span><span class="p">)</span><span class="go"></span>
<span class="go">[&#39;aaa&#39;, &#39;aba&#39;, &#39;abba&#39;]</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="sb">`a(a</span><span class="sr">+|</span><span class="sb">b</span><span class="sr">+</span><span class="sb">)a`</span><span class="p">)</span><span class="go"></span>
<span class="go">3</span>
</pre></div>
</div>
<p>This same kind of search is performed if the backticks are prefaced with <code class="docutils literal notranslate"><span class="pre">r</span></code>.
So the following expressions are equivalent: <code class="docutils literal notranslate"><span class="pre">`test`</span></code> and <code class="docutils literal notranslate"><span class="pre">r`test`</span></code>.</p>
<p>Other than the regex matching, this functions in the same way as normal
globbing.  For more information, please see the documentation for the <code class="docutils literal notranslate"><span class="pre">re</span></code>
module in the Python standard library.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In Xonsh, the meaning of backticks is very different from their
meaning in Bash.
In Bash, backticks mean to run a captured subprocess
(<code class="docutils literal notranslate"><span class="pre">$()</span></code> in Xonsh).</p>
</div>
</section>
<section id="normal-globbing">
<h3>Normal Globbing<a class="headerlink" href="#normal-globbing" title="Permalink to this headline">¶</a></h3>
<p>In subprocess mode, normal globbing happens without any special syntax.
However, the backtick syntax has an additional feature: it is available inside
of Python mode as well as subprocess mode.</p>
<p>Similarly to regex globbing, normal globbing can be performed (either in Python
mode or subprocess mode) by using the <code class="docutils literal notranslate"><span class="pre">g``</span></code>:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">touch</span> <span class="n">a</span> <span class="n">aa</span> <span class="n">aaa</span> <span class="n">aba</span> <span class="n">abba</span> <span class="n">aab</span> <span class="n">aabb</span> <span class="n">abcba</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="go"></span>
<span class="go">aab  aabb  aba  abba  abcba</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">ls</span> <span class="sa">g</span><span class="sb">`a</span><span class="sr">*</span><span class="sb">b</span><span class="sr">*</span><span class="sb">`</span><span class="go"></span>
<span class="go">aab  aabb  aba  abba  abcba</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="sa">g</span><span class="sb">`a</span><span class="sr">*</span><span class="sb">b</span><span class="sr">*</span><span class="sb">`</span><span class="p">)</span><span class="go"></span>
<span class="go">[&#39;aab&#39;, &#39;aabb&#39;, &#39;abba&#39;, &#39;abcba&#39;, &#39;aba&#39;]</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="sa">g</span><span class="sb">`a</span><span class="sr">*</span><span class="sb">b</span><span class="sr">*</span><span class="sb">`</span><span class="p">)</span><span class="go"></span>
<span class="go">5</span>
</pre></div>
</div>
</section>
<section id="custom-path-searches">
<h3>Custom Path Searches<a class="headerlink" href="#custom-path-searches" title="Permalink to this headline">¶</a></h3>
<p>In addition, if normal globbing and regular expression globbing are not enough,
xonsh allows you to specify your own search functions.</p>
<p>A search function is defined as a function of a single argument (a string) that
returns a list of possible matches to that string.  Search functions can then
be used with backticks with the following syntax: <code class="docutils literal notranslate"><span class="pre">&#64;&lt;name&gt;`test`</span></code></p>
<p>The following example shows the form of these functions:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="gp"></span>
<span class="gp">...</span>     <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nd">@foo</span><span class="sb">`aa`</span><span class="go"></span>
<span class="go">[&#39;aa&#39;, &#39;aaa&#39;, &#39;aab&#39;, &#39;aabb&#39;]</span>
</pre></div>
</div>
</section>
<section id="path-output">
<h3>Path Output<a class="headerlink" href="#path-output" title="Permalink to this headline">¶</a></h3>
<p>Using the <code class="docutils literal notranslate"><span class="pre">p</span></code> modifier with either regex or glob backticks changes the
return type from a list of strings to a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code> objects:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="sb">`</span><span class="sr">.*</span><span class="sb">`</span><span class="go"></span>
<span class="go">[Path(&#39;foo&#39;), Path(&#39;bar&#39;)]</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pg</span><span class="sb">`</span><span class="sr">**</span><span class="sb">`</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">is_symlink</span><span class="p">()]</span><span class="go"></span>
<span class="go">[Path(&#39;a_link&#39;)]</span>
</pre></div>
</div>
</section>
<section id="path-literals">
<h3>Path Literals<a class="headerlink" href="#path-literals" title="Permalink to this headline">¶</a></h3>
<p>Path objects can be instantiated directly using <em>p-string</em> syntax. Path objects
can be converted back to plain strings with <cite>str()</cite>, and this conversion is
handled implicitly in subprocess mode.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mypath</span> <span class="o">=</span> <span class="n">p</span><span class="s1">&#39;/foo/bar&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">mypath</span><span class="go"></span>
<span class="go">Path(&#39;/foo/bar&#39;)</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">mypath</span><span class="o">.</span><span class="n">stem</span><span class="go"></span>
<span class="go">&#39;bar&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="k">@</span><span class="p">(</span><span class="n">mypath</span><span class="p">)</span><span class="go"></span>
<span class="go">/foo/bar</span>
</pre></div>
</div>
<p>Path object allows do some tricks with paths. Globbing certain path, checking and getting info:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mypath</span> <span class="o">=</span> <span class="n">p</span><span class="s1">&#39;/etc&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">mypath</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*bashrc*&#39;</span><span class="p">))</span><span class="go"></span>
<span class="go">[Path(&#39;/etc/bash.bashrc&#39;), Path(&#39;/etc/skel/.bashrc&#39;)]</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="p">[</span><span class="n">mypath</span><span class="o">.</span><span class="n">exists</span><span class="p">(),</span> <span class="n">mypath</span><span class="o">.</span><span class="n">is_dir</span><span class="p">(),</span> <span class="n">mypath</span><span class="o">.</span><span class="n">is_file</span><span class="p">(),</span> <span class="n">mypath</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">mypath</span><span class="o">.</span><span class="n">owner</span><span class="p">()]</span><span class="go"></span>
<span class="go">[True, True, False, Path(&#39;/&#39;), &#39;root&#39;]</span>
</pre></div>
</div>
</section>
</section>
<section id="help-superhelp-with">
<h2>Help &amp; Superhelp with <code class="docutils literal notranslate"><span class="pre">?</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">??</span></code><a class="headerlink" href="#help-superhelp-with" title="Permalink to this headline">¶</a></h2>
<p>From IPython, xonsh allows you to inspect objects with question marks.
A single question mark (<code class="docutils literal notranslate"><span class="pre">?</span></code>) is used to display the normal level of help.
Double question marks (<code class="docutils literal notranslate"><span class="pre">??</span></code>) are used to display a higher level of help,
called superhelp. Superhelp usually includes source code if the object was
written in pure Python.</p>
<p>Let’s start by looking at the help for the int type:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="k">?</span><span class="go"></span>
<span class="go">Type:            type</span>
<span class="go">String form:     &lt;class &#39;int&#39;&gt;</span>
<span class="go">Init definition: (self, *args, **kwargs)</span>
<span class="go">Docstring:</span>
<span class="go">int(x=0) -&gt; integer</span>
<span class="go">int(x, base=10) -&gt; integer</span>

<span class="go">Convert a number or string to an integer, or return 0 if no arguments</span>
<span class="go">are given.  If x is a number, return x.__int__().  For floating point</span>
<span class="go">numbers, this truncates towards zero.</span>

<span class="go">If x is not a number or if base is given, then x must be a string,</span>
<span class="go">bytes, or bytearray instance representing an integer literal in the</span>
<span class="go">given base.  The literal can be preceded by &#39;+&#39; or &#39;-&#39; and be surrounded</span>
<span class="go">by whitespace.  The base defaults to 10.  Valid bases are 0 and 2-36.</span>
<span class="go">Base 0 means to interpret the base from the string as an integer literal.</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;0b100&#39;</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="go"></span>
<span class="go">4</span>
<span class="go">&lt;class &#39;int&#39;&gt;</span>
</pre></div>
</div>
<p>Now, let’s look at the superhelp for the xonsh built-in that enables
regex globbing:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">__xonsh__</span><span class="o">.</span><span class="n">regexsearch</span><span class="k">??</span><span class="go"></span>
<span class="go">Type:         function</span>
<span class="go">String form:  &lt;function regexsearch at 0x7efc8b367d90&gt;</span>
<span class="go">File:         /usr/local/lib/python3.5/dist-packages/xonsh/built_ins.py</span>
<span class="go">Definition:   (s)</span>
<span class="go">Source:</span>
<span class="go">def regexsearch(s):</span>
<span class="go">    s = expand_path(s)</span>
<span class="go">    return reglob(s)</span>


<span class="go">&lt;function xonsh.built_ins.regexsearch&gt;</span>
</pre></div>
</div>
<p>Note that both help and superhelp return the object that they are inspecting.
This allows you to chain together help inside of other operations and
ask for help several times in an object hierarchy.  For instance, let’s get
help for both the dict type and its key() method simultaneously:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dict</span><span class="k">?</span><span class="o">.</span><span class="n">keys</span><span class="k">??</span><span class="go"></span>
<span class="go">Type:            type</span>
<span class="go">String form:     &lt;class &#39;dict&#39;&gt;</span>
<span class="go">Init definition: (self, *args, **kwargs)</span>
<span class="go">Docstring:</span>
<span class="go">dict() -&gt; new empty dictionary</span>
<span class="go">dict(mapping) -&gt; new dictionary initialized from a mapping object&#39;s</span>
<span class="go">    (key, value) pairs</span>
<span class="go">dict(iterable) -&gt; new dictionary initialized as if via:</span>
<span class="go">    d = {}</span>
<span class="go">    for k, v in iterable:</span>
<span class="go">        d[k] = v</span>
<span class="go">dict(**kwargs) -&gt; new dictionary initialized with the name=value pairs</span>
<span class="go">    in the keyword argument list.  For example:  dict(one=1, two=2)</span>
<span class="go">Type:        method_descriptor</span>
<span class="go">String form: &lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;</span>
<span class="go">Docstring:   D.keys() -&gt; a set-like object providing a view on D&#39;s keys</span>
<span class="go">&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;</span>
</pre></div>
</div>
<p>Of course, for subprocess commands, you still want to use the <code class="docutils literal notranslate"><span class="pre">man</span></code> command.</p>
</section>
<section id="compile-evaluate-execute">
<h2>Compile, Evaluate, &amp; Execute<a class="headerlink" href="#compile-evaluate-execute" title="Permalink to this headline">¶</a></h2>
<p>Like Python and Bash, xonsh provides built-in hooks to compile, evaluate,
and execute strings of xonsh code.  To prevent this functionality from having
serious name collisions with the Python built-in <code class="docutils literal notranslate"><span class="pre">compile()</span></code>, <code class="docutils literal notranslate"><span class="pre">eval()</span></code>,
and <code class="docutils literal notranslate"><span class="pre">exec()</span></code> functions, the xonsh equivalents all append an ‘x’.  So for
xonsh code you want to use the <code class="docutils literal notranslate"><span class="pre">compilex()</span></code>, <code class="docutils literal notranslate"><span class="pre">evalx()</span></code>, and <code class="docutils literal notranslate"><span class="pre">execx()</span></code>
functions. If you don’t know what these do, you probably don’t need them.</p>
</section>
<section id="aliases">
<h2>Aliases<a class="headerlink" href="#aliases" title="Permalink to this headline">¶</a></h2>
<p>Another important xonsh built-in is the <code class="docutils literal notranslate"><span class="pre">aliases</span></code> mapping.  This is
like a dictionary that affects how subprocess commands are run.  If you are
familiar with the Bash <code class="docutils literal notranslate"><span class="pre">alias</span></code> built-in, this is similar.  Alias command
matching only occurs for the first element of a subprocess command.</p>
<p>The keys of <code class="docutils literal notranslate"><span class="pre">aliases</span></code> are strings that act as commands in subprocess-mode.
The values are lists of strings, where the first element is the command, and
the rest are the arguments.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;ls&#39;</span><span class="p">]</span><span class="go"></span>
<span class="go">[&#39;ls&#39;, &#39;--color=auto&#39;, &#39;-v&#39;]</span>
</pre></div>
</div>
<p>You can also set the value to a string. If the string is a xonsh expression,
it will be converted to a list automatically with xonsh’s <code class="docutils literal notranslate"><span class="pre">Lexer.split()</span></code> method.
For example, the following creates several aliases for the <code class="docutils literal notranslate"><span class="pre">git</span></code> version
control software. Both styles (list of strings and single string) are shown:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;git status -sb&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;gco&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;git checkout&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;gp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;pull&#39;</span><span class="p">]</span><span class="go"></span>
</pre></div>
</div>
<p>If you were to run <code class="docutils literal notranslate"><span class="pre">gco</span> <span class="pre">feature-fabulous</span></code> with the above aliases in effect,
the command would reduce to <code class="docutils literal notranslate"><span class="pre">['git',</span> <span class="pre">'checkout',</span> <span class="pre">'feature-fabulous']</span></code> before
being executed.</p>
<p>If the string is representing a block of xonsh code, the alias will be registered
as an <code class="docutils literal notranslate"><span class="pre">ExecAlias</span></code>, which is a callable alias. This block of code will then be
executed whenever the alias is run. The arguments are available in the list <code class="docutils literal notranslate"><span class="pre">$args</span></code>
or by the index in <code class="docutils literal notranslate"><span class="pre">$arg&lt;n&gt;</span></code> environment variables.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;answer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;echo @(21+21)&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;piu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pip install -U @($args)&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;cdls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cd $arg0 &amp;&amp; ls&#39;</span><span class="go"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To add multiple aliases there is merge operator: <code class="docutils literal notranslate"><span class="pre">aliases</span> <span class="pre">|=</span> <span class="pre">{'e':</span> <span class="pre">'echo',</span> <span class="pre">'g':</span> <span class="pre">'git'}</span></code>.</p>
</div>
<section id="callable-aliases">
<h3>Callable Aliases<a class="headerlink" href="#callable-aliases" title="Permalink to this headline">¶</a></h3>
<p>Lastly, if an alias value is a function (or other callable), then this
function is called <em>instead</em> of going to a subprocess command. Such functions
may have one of the following signatures:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mycmd0</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;This form takes no arguments but may return output or a return code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;some output.&quot;</span>

<span class="k">def</span> <span class="nf">mycmd1</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This form takes a single argument, args. This is a list of strings</span>
<span class="sd">    representing the arguments to this command. Feel free to parse them</span>
<span class="sd">    however you wish!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># perform some action.</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">mycmd2</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This form takes two arguments. The args list like above, as a well</span>
<span class="sd">    as standard input. stdin will be a file like object that the command</span>
<span class="sd">    can read from, if the user piped input to this command. If no input</span>
<span class="sd">    was provided this will be None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># do whatever you want! Anything you print to stdout or stderr</span>
    <span class="c1"># will be captured for you automatically. This allows callable</span>
    <span class="c1"># aliases to support piping.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;I go to stdout and will be printed or piped&#39;</span><span class="p">)</span>

    <span class="c1"># Note: that you have access to the xonsh</span>
    <span class="c1"># built-ins if you &#39;import builtins&#39;.  For example, if you need the</span>
    <span class="c1"># environment, you could do to following:</span>
    <span class="kn">import</span> <span class="nn">builtins</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">__xonsh__</span><span class="o">.</span><span class="n">env</span>

    <span class="c1"># The return value of the function can either be None,</span>
    <span class="k">return</span>

    <span class="c1"># a single string representing stdout</span>
    <span class="k">return</span>  <span class="s1">&#39;I am out of here&#39;</span>

    <span class="c1"># or you can build up strings for stdout and stderr and then</span>
    <span class="c1"># return a (stdout, stderr) tuple. Both of these may be</span>
    <span class="c1"># either a str or None. Any results returned like this will be</span>
    <span class="c1"># concatenated with the strings printed elsewhere in the function.</span>
    <span class="n">stdout</span> <span class="o">=</span> <span class="s1">&#39;I commanded&#39;</span>
    <span class="n">stderr</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span>

    <span class="c1"># Lastly, a 3-tuple return value can be used to include an integer</span>
    <span class="c1"># return code indicating failure (&gt; 0 return code). In the previous</span>
    <span class="c1"># examples the return code would be 0/success.</span>
    <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;I failed&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mycmd3</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This form has three parameters.  The first two are the same as above.</span>
<span class="sd">    The last argument represents the standard output.  This is a file-like</span>
<span class="sd">    object that the command may write too.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># you can either use stdout</span>
    <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Hello, &quot;</span><span class="p">)</span>
    <span class="c1"># or print()!</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mom!&quot;</span><span class="p">)</span>
    <span class="k">return</span>

<span class="k">def</span> <span class="nf">mycmd4</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The next form of subprocess callables takes all of the</span>
<span class="sd">    arguments shown above as well as the standard error stream.</span>
<span class="sd">    As with stdout, this is a write-only file-like object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This form allows &quot;streaming&quot; data to stdout and stderr</span>
    <span class="kn">import</span> <span class="nn">time</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">stdout</span><span class="p">)</span>

    <span class="c1"># In this form, the return value should be a single integer</span>
    <span class="c1"># representing the &quot;return code&quot; of the alias (zero if successful,</span>
    <span class="c1"># non-zero otherwise)</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">mycmd5</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This form of subprocess callables takes all of the</span>
<span class="sd">    arguments shown above as well as a subprocess specification</span>
<span class="sd">    SubprocSpec object. This holds many attributes that dictate how</span>
<span class="sd">    the command is being run.  For instance this can be useful for</span>
<span class="sd">    knowing if the process is captured by $() or !().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">xonsh.proc</span>
    <span class="k">if</span> <span class="n">spec</span><span class="o">.</span><span class="n">captured</span> <span class="ow">in</span> <span class="n">xonsh</span><span class="o">.</span><span class="n">proc</span><span class="o">.</span><span class="n">STDOUT_CAPTURE_KINDS</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I&#39;m being captured!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">spec</span><span class="o">.</span><span class="n">last_in_pipeline</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Going through a pipe!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello terminal!&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">mycmd6</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Lastly, the final form of subprocess callables takes a stack argument</span>
<span class="sd">    in addition to the arguments shown above. The stack is a list of</span>
<span class="sd">    FrameInfo namedtuple objects, as described in the standard library</span>
<span class="sd">    inspect module. The stack is computed such the the call site is the</span>
<span class="sd">    first and innermost entry, while the outer frame is the last entry.</span>

<span class="sd">    The stack is only computed if the alias has a &quot;stack&quot; argument.</span>
<span class="sd">    However, the stack is also accessible as &quot;spec.stack&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">frame_info</span> <span class="ow">in</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">frame_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;In function &#39;</span> <span class="o">+</span> <span class="n">frame_info</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  locals&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_locals</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  globals&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">f_globals</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="adding-modifying-and-removing-aliases">
<h3>Adding, Modifying, and Removing Aliases<a class="headerlink" href="#adding-modifying-and-removing-aliases" title="Permalink to this headline">¶</a></h3>
<p>We can dynamically alter the aliases present simply by modifying the
built-in mapping.  Here is an example using a function value:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">_banana</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span><span class="gp"></span>
<span class="gp">...</span>     <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;My spoon is tooo big!&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;banana&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_banana</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">banana</span><span class="go"></span>
<span class="go">&#39;My spoon is tooo big!&#39;</span>
</pre></div>
</div>
<p>To redefine an alias, simply assign a new function, here using a python lambda
with keyword arguments:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;banana&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="s2">&quot;Banana for scale.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">banana</span><span class="go"></span>
<span class="go">Banana for scale.</span>
</pre></div>
</div>
<p>Removing an alias is as easy as deleting the key from the alias dictionary:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;banana&#39;</span><span class="p">]</span><span class="go"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Alias functions should generally be defined with a leading underscore.
Otherwise, they may shadow the alias itself, as Python variables take
precedence over aliases when xonsh executes commands.</p>
</div>
</section>
<section id="anonymous-aliases">
<h3>Anonymous Aliases<a class="headerlink" href="#anonymous-aliases" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, it is also possible to treat functions outside this mapping
as aliases, by wrapping them in <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code>.  For example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">@</span><span class="p">(</span><span class="n">_banana</span><span class="p">)</span><span class="go"></span>
<span class="go">&#39;My spoon is tooo big!&#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">echo</span> <span class="s2">&quot;hello&quot;</span> <span class="o">|</span> <span class="k">@</span><span class="p">(</span><span class="k">lambda</span> <span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">:</span> <span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="n">world</span><span class="go"></span>
<span class="go">hello world</span>
</pre></div>
</div>
</section>
<section id="unthreadable-aliases">
<h3>Unthreadable Aliases<a class="headerlink" href="#unthreadable-aliases" title="Permalink to this headline">¶</a></h3>
<p>Usually, callable alias commands will be run in a separate thread so that
they may be run in the background.  However, some aliases may need to be
executed on the thread that they were called from. This is mostly useful for
debuggers and profilers. To make an alias run in the foreground, decorate its
function with the <code class="docutils literal notranslate"><span class="pre">xonsh.tools.unthreadable</span></code> decorator.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xonsh.tools</span> <span class="kn">import</span> <span class="n">unthreadable</span>

<span class="nd">@unthreadable</span>
<span class="k">def</span> <span class="nf">_mycmd</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;In your face!&#39;</span>

<span class="n">aliases</span><span class="p">[</span><span class="s1">&#39;mycmd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_mycmd</span>
</pre></div>
</div>
</section>
<section id="uncapturable-aliases">
<h3>Uncapturable Aliases<a class="headerlink" href="#uncapturable-aliases" title="Permalink to this headline">¶</a></h3>
<p>Also, callable aliases by default will be executed such that their output is
captured (like most commands in xonsh that don’t enter alternate mode).
However, some aliases may want to run alternate-mode commands themselves.
Thus the callable alias can’t be captured without dire consequences (tm).
To prevent this, you can declare a callable alias uncapturable. This is mostly
useful for aliases that then open up text editors, pagers, or the like.
To make an alias uncapturable, decorate its
function with the <code class="docutils literal notranslate"><span class="pre">xonsh.tools.uncapturable</span></code> decorator. This is probably
best used in conjunction with the <code class="docutils literal notranslate"><span class="pre">unthreadable</span></code> decorator.  For example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xonsh.tools</span> <span class="kn">import</span> <span class="n">unthreadable</span><span class="p">,</span> <span class="n">uncapturable</span><span class="go"></span>

<span class="go">@uncapturable</span>
<span class="go">@unthreadable</span>
<span class="go">def _binvi(args, stdin=None):</span>
<span class="go">    vi -b @(args)  # Edit binary files</span>

<span class="go">aliases[&#39;bvi&#39;] = _binvi</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code> is required to pass the python list <code class="docutils literal notranslate"><span class="pre">args</span></code> to a subprocess
command.</p>
<hr class="docutils" />
<p>Aliasing is a powerful way that xonsh allows you to seamlessly interact to
with Python and subprocess.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">FOREIGN_ALIASES_OVERRIDE</span></code> environment variable is False
(the default) then foreign shell aliases that try to override
xonsh aliases will be ignored. Setting of this environment variable
must happen outside if xonsh, i.e. in the process that starts xonsh.</p>
</div>
</section>
</section>
<section id="up-down-tab">
<h2>Up, Down, Tab<a class="headerlink" href="#up-down-tab" title="Permalink to this headline">¶</a></h2>
<p>The up and down keys search history matching from the start of the line,
much like they do in the IPython shell.</p>
<p>Tab completion is present as well. By default, in Python-mode you are able to
complete based on the variable names in the current builtins, globals, and
locals, as well as xonsh languages keywords &amp; operator, files &amp; directories,
and environment variable names. In subprocess-mode, you additionally complete
on the names of executable files on your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>, alias keys, and full Bash
completion for the commands themselves.</p>
<p>xonsh also provides a means of modifying the behavior of the tab completer.  More
detail is available on the <a class="reference external" href="tutorial_completers.html">Tab Completion page</a>.</p>
</section>
<section id="customizing-the-prompt">
<span id="customprompt"></span><h2>Customizing the Prompt<a class="headerlink" href="#customizing-the-prompt" title="Permalink to this headline">¶</a></h2>
<p>Customizing the prompt by modifying <code class="docutils literal notranslate"><span class="pre">$PROMPT</span></code>, <code class="docutils literal notranslate"><span class="pre">$RIGHT_PROMPT</span></code> or <code class="docutils literal notranslate"><span class="pre">$BOTTOM_TOOLBAR</span></code>
is probably the most common reason for altering an environment variable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">$PROMPT</span></code> variable will never be inherited from a
parent process (regardless of whether that parent is a foreign shell
or an instance of xonsh).</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">$PROMPT</span></code> variable can be a string, or it can be a function (of no
arguments) that returns a string.  The result can contain keyword arguments,
which will be replaced automatically:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nv">$PROMPT</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{user}</span><span class="s1">@</span><span class="si">{hostname}</span><span class="s1">:</span><span class="si">{cwd}</span><span class="s1"> &gt; &#39;</span><span class="go"></span>
<span class="go">snail@home:~ &gt; # it works!</span>
<span class="go">snail@home:~ &gt; $PROMPT = lambda: &#39;{user}@{hostname}:{cwd} &gt;&gt; &#39;</span>
<span class="go">snail@home:~ &gt;&gt; # so does that!</span>
</pre></div>
</div>
<p>By default, the following variables are available for use:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code>: The username of the current user</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hostname</span></code>: The name of the host computer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cwd</span></code>: The current working directory, you may use <code class="docutils literal notranslate"><span class="pre">$DYNAMIC_CWD_WIDTH</span></code> to
set a maximum width for this variable and <code class="docutils literal notranslate"><span class="pre">$DYNAMIC_CWD_ELISION_CHAR</span></code> to
set the character used in shortened path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short_cwd</span></code>: A shortened form of the current working directory; e.g.,
<code class="docutils literal notranslate"><span class="pre">/path/to/xonsh</span></code> becomes <code class="docutils literal notranslate"><span class="pre">/p/t/xonsh</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cwd_dir</span></code>: The dirname of the current working directory, e.g. <code class="docutils literal notranslate"><span class="pre">/path/to/</span></code> in
<code class="docutils literal notranslate"><span class="pre">/path/to/xonsh</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cwd_base</span></code>: The basename of the current working directory, e.g. <code class="docutils literal notranslate"><span class="pre">xonsh</span></code> in
<code class="docutils literal notranslate"><span class="pre">/path/to/xonsh</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env_name</span></code>: The name of active virtual environment, if any. The rendering
of this variable is affected by the <code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_PROMPT</span></code> and
<code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_DISABLE_PROMPT</span></code> environment variables; see below.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env_prefix</span></code>: The prefix characters if there is an active virtual environment,
defaults to <code class="docutils literal notranslate"><span class="pre">&quot;(&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">env_postfix</span></code>: The postfix characters if there is an active virtual environment,
defaults to <code class="docutils literal notranslate"><span class="pre">&quot;)</span> <span class="pre">&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curr_branch</span></code>: The name of the current git branch, if any.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">branch_color</span></code>: <code class="docutils literal notranslate"><span class="pre">{BOLD_GREEN}</span></code> if the current git branch is clean,
otherwise <code class="docutils literal notranslate"><span class="pre">{BOLD_RED}</span></code>. This is yellow if the branch color could not be
determined.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">branch_bg_color</span></code>: Like, <code class="docutils literal notranslate"><span class="pre">{branch_color}</span></code>, but sets a background color
instead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prompt_end</span></code>: <code class="docutils literal notranslate"><span class="pre">#</span></code> if the user has root/admin permissions <code class="docutils literal notranslate"><span class="pre">$</span></code> otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">current_job</span></code>: The name of the command currently running in the
foreground, if any.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vte_new_tab_cwd</span></code>: Issues VTE escape sequence for opening new tabs in the
current working directory on some linux terminals. This is not usually needed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gitstatus</span></code>: Informative git status, like <code class="docutils literal notranslate"><span class="pre">[main|MERGING|+1…2]</span></code>, you
may use <a class="reference external" href="envvars.html">$XONSH_GITSTATUS_*</a> to customize the styling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">localtime</span></code>: The current, local time as given by <code class="docutils literal notranslate"><span class="pre">time.localtime()</span></code>.
This is formatted with the time format string found in <code class="docutils literal notranslate"><span class="pre">time_format</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time_format</span></code>: A time format string, defaulting to <code class="docutils literal notranslate"><span class="pre">&quot;%H:%M:%S&quot;</span></code>.</p></li>
</ul>
</div></blockquote>
<p>To override any of these variables, or to add your own, change the <code class="docutils literal notranslate"><span class="pre">$PROMPT_FIELDS</span></code> environment variable.
To set a field, index it. For example, <code class="docutils literal notranslate"><span class="pre">$PROMPT_FIELDS[&#39;time_format&#39;] = &#39;%H:%M:%S&#39;</span></code>.
You can also insert custom fields; custom fields can either be values or functions that take no arguments.</p>
<p>xonsh obeys the <code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_DISABLE_PROMPT</span></code> environment variable
<a class="reference external" href="https://virtualenv.pypa.io/en/latest/reference/#envvar-VIRTUAL_ENV_DISABLE_PROMPT">as defined by virtualenv</a>. If this variable is truthy, xonsh
will <em>always</em> substitute an empty string for <code class="docutils literal notranslate"><span class="pre">{env_name}</span></code>. Note that unlike
with other shells, <code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_DISABLE_PROMPT</span></code> takes effect <em>immediately</em>
after being set—it is not necessary to re-activate the environment.</p>
<p>xonsh also allows for an explicit override of the rendering of <code class="docutils literal notranslate"><span class="pre">{env_name}</span></code>,
via the <code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_PROMPT</span></code> environment variable. If this variable is
defined and has any value other than <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">{env_name}</span></code> will <em>always</em>
render as <code class="docutils literal notranslate"><span class="pre">str($VIRTUAL_ENV_PROMPT)</span></code> when an environment is activated.
It will still render as an empty string when no environment is active.
<code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_PROMPT</span></code> is overridden by <code class="docutils literal notranslate"><span class="pre">$VIRTUAL_ENV_DISABLE_PROMPT</span></code>.</p>
<p>For example:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nv">$PROMPT</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{env_name}</span><span class="s1">&gt;&gt;&gt; &#39;</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="n">source</span> <span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span><span class="o">.</span><span class="n">xsh</span><span class="go"></span>
<span class="go">(env) &gt;&gt;&gt; $VIRTUAL_ENV_PROMPT = &#39;~~ACTIVE~~ &#39;</span>
<span class="go">~~ACTIVE~~ &gt;&gt;&gt; $VIRTUAL_ENV_DISABLE_PROMPT = 1</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="nv">$VIRTUAL_ENV_PROMPT</span><span class="gp"></span>
<span class="gp">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="nv">$VIRTUAL_ENV_DISABLE_PROMPT</span><span class="go"></span>
<span class="go">(env) &gt;&gt;&gt;</span>
</pre></div>
</div>
<p>You can also color your prompt (or print colored messages using <code class="docutils literal notranslate"><span class="pre">print_color</span></code> function) easily by inserting
keywords such as <code class="docutils literal notranslate"><span class="pre">{GREEN}</span></code> or <code class="docutils literal notranslate"><span class="pre">{BOLD_BLUE}</span></code>.  Colors have the form shown below:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">RESET</span></code>: Resets any previously used styling.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COLORNAME</span></code>: Inserts a color code for the following basic colors,
which come in regular (dark) and intense (light) forms:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BLACK</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_BLACK</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RED</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_RED</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GREEN</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_GREEN</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">YELLOW</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_YELLOW</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLUE</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_BLUE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PURPLE</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_PURPLE</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CYAN</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_CYAN</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WHITE</span></code> or <code class="docutils literal notranslate"><span class="pre">INTENSE_WHITE</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code>: The color code for the terminal’s default foreground color.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#HEX</span></code>: A <code class="docutils literal notranslate"><span class="pre">#</span></code> before a len-3 or len-6 hex code will use that
hex color, or the nearest approximation that that is supported by
the shell and terminal.  For example, <code class="docutils literal notranslate"><span class="pre">#fff</span></code> and <code class="docutils literal notranslate"><span class="pre">#fafad2</span></code> are
both valid.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BACKGROUND_</span></code> may be added to the beginning of a color name or hex
color to set a background color.  For example, <code class="docutils literal notranslate"><span class="pre">BACKGROUND_INTENSE_RED</span></code>
and <code class="docutils literal notranslate"><span class="pre">BACKGROUND_#123456</span></code> can both be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bg#HEX</span></code> or <code class="docutils literal notranslate"><span class="pre">BG#HEX</span></code> are shortcuts for setting a background hex color.
Thus you can set <code class="docutils literal notranslate"><span class="pre">bg#0012ab</span></code> or the uppercase version.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BOLD_</span></code> is a prefix modifier that increases the intensity of the font.
It may be used with any foreground color.
For example, <code class="docutils literal notranslate"><span class="pre">BOLD_RED</span></code> and <code class="docutils literal notranslate"><span class="pre">BOLD_#112233</span></code> are OK!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAINT_</span></code> is a prefix modifier that decreases the intensity of the font.
For example, <code class="docutils literal notranslate"><span class="pre">FAINT_YELLOW</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ITALIC_</span></code> is a prefix modifier that switches to an italic font.
For example, <code class="docutils literal notranslate"><span class="pre">ITALIC_BLUE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UNDERLINE_</span></code> is a prefix qualifier that also may be used with any
foreground color. For example, <code class="docutils literal notranslate"><span class="pre">UNDERLINE_GREEN</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SLOWBLINK_</span></code> is a prefix modifier makes the text blink, slowly.
For example, <code class="docutils literal notranslate"><span class="pre">SLOWBLINK_PURPLE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FASTBLINK_</span></code> is a prefix modifier makes the text blink, quickly.
For example, <code class="docutils literal notranslate"><span class="pre">FASTBLINK_CYAN</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INVERT_</span></code> is a prefix modifier swaps the foreground and background colors.
For example, <code class="docutils literal notranslate"><span class="pre">INVERT_WHITE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONCEAL_</span></code> is a prefix modifier which hides the text. This may not be
widely supported. For example, <code class="docutils literal notranslate"><span class="pre">CONCEAL_BLACK</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STRIKETHROUGH_</span></code> is a prefix modifier which draws a line through the text.
For example, <code class="docutils literal notranslate"><span class="pre">STRIKETHROUGH_RED</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BOLDOFF_</span></code> is a prefix modifier for removing the intensity of the font.
It may be used with any foreground color.
For example, <code class="docutils literal notranslate"><span class="pre">BOLDOFF_RED</span></code> and <code class="docutils literal notranslate"><span class="pre">BOLDOFF_#112233</span></code> are OK!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FAINTOFF_</span></code> is a prefix modifier for removing the faintness of the font.
For example, <code class="docutils literal notranslate"><span class="pre">FAINTOFF_YELLOW</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ITALICOFF_</span></code> is a prefix modifier that removes an italic font.
For example, <code class="docutils literal notranslate"><span class="pre">ITALICOFF_BLUE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UNDERLINEOFF_</span></code> is a prefix qualifier for removing the underline of a
foreground color. For example, <code class="docutils literal notranslate"><span class="pre">UNDERLINEOFF_GREEN</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BLINKOFF_</span></code> is a prefix modifier removing the text blinking,
whether that is slow or fast. For example, <code class="docutils literal notranslate"><span class="pre">BLINKOFF_PURPLE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INVERTOFF_</span></code> is a prefix modifier restoring the foreground and background colors.
For example, <code class="docutils literal notranslate"><span class="pre">INVERTOFF_WHITE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONCEALOFF_</span></code> is a prefix modifier which shows the text. This may not be
widely supported. For example, <code class="docutils literal notranslate"><span class="pre">CONCEALOFF_BLACK</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STRIKETHROUGHOFF_</span></code> is a prefix modifier removing lines through the text.
For example, <code class="docutils literal notranslate"><span class="pre">STRIKETHROUGHOFF_RED</span></code>.</p></li>
<li><p>Or any other combination of modifiers, such as
<code class="docutils literal notranslate"><span class="pre">BOLD_UNDERLINE_INTENSE_BLACK</span></code>,   which is the most metal color you
can use!</p></li>
</ul>
<p>You can make use of additional variables beyond these by adding them to the
<code class="docutils literal notranslate"><span class="pre">PROMPT_FIELDS</span></code> environment variable.  The values in this dictionary
should be strings (which will be inserted into the prompt verbatim), or
functions of no arguments (which will be called each time the prompt is
generated, and the results of those calls will be inserted into the prompt).
For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">snail@home ~ $ </span><span class="nv">$PROMPT_FIELDS</span><span class="o">[</span><span class="s1">&#39;test&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;hey&quot;</span>
<span class="gp">snail@home ~ $ </span><span class="nv">$PROMPT</span> <span class="o">=</span> <span class="s2">&quot;{test} {cwd} </span>$<span class="s2"> &quot;</span>
<span class="go">hey ~ $</span>
<span class="go">hey ~ $ import random</span>
<span class="go">hey ~ $ $PROMPT_FIELDS[&#39;test&#39;] = lambda: random.randint(1,9)</span>
<span class="go">3 ~ $</span>
<span class="go">5 ~ $</span>
<span class="go">2 ~ $</span>
<span class="go">8 ~ $</span>
</pre></div>
</div>
<p>Environment variables and functions are also available with the <code class="docutils literal notranslate"><span class="pre">$</span></code>
prefix.  For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">snail@home ~ $ </span><span class="nv">$PROMPT</span> <span class="o">=</span> <span class="s2">&quot;{</span><span class="nv">$LANG</span><span class="s2">} &gt;&quot;</span>
<span class="go">en_US.utf8 &gt;</span>
</pre></div>
</div>
<p>Note that some entries of the <code class="docutils literal notranslate"><span class="pre">$PROMPT_FIELDS</span></code> are not always applicable, for
example, <code class="docutils literal notranslate"><span class="pre">curr_branch</span></code> returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the current directory is not in a
repository. The <code class="docutils literal notranslate"><span class="pre">None</span></code> will be interpreted as an empty string.</p>
<p>But let’s consider a problem:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">snail@home ~/xonsh $ </span><span class="nv">$PROMPT</span> <span class="o">=</span> <span class="s2">&quot;{cwd_base} [{curr_branch}] </span>$<span class="s2"> &quot;</span>
<span class="go">xonsh [main] $ cd ..</span>
<span class="go">~ [] $</span>
</pre></div>
</div>
<p>We want the branch to be displayed in square brackets, but we also don’t want
the brackets (and the extra space) to be displayed when there is no branch. The
solution is to add a nested format string (separated with a colon) that will be
invoked only if the value is not <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">snail@home ~/xonsh $ </span><span class="nv">$PROMPT</span> <span class="o">=</span> <span class="s2">&quot;{cwd_base}{curr_branch: [{}]} </span>$<span class="s2"> &quot;</span>
<span class="go">xonsh [main] $ cd ..</span>
<span class="go">~ $</span>
</pre></div>
</div>
<p>The curly brackets act as a placeholder, because the additional part is an
ordinary format string. What we’re doing here is equivalent to this expression:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot; [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">curr_branch</span><span class="p">())</span> <span class="k">if</span> <span class="n">curr_branch</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="executing-commands-and-scripts">
<h2>Executing Commands and Scripts<a class="headerlink" href="#executing-commands-and-scripts" title="Permalink to this headline">¶</a></h2>
<p>When started with the <code class="docutils literal notranslate"><span class="pre">-c</span></code> flag and a command, xonsh will execute that command
and exit, instead of entering the command loop.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xonsh -c <span class="s2">&quot;echo @(7+3)&quot;</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Longer scripts can be run either by specifying a filename containing the script,
or by feeding them to xonsh via stdin.  For example, consider the following
script, stored in <code class="docutils literal notranslate"><span class="pre">test.xsh</span></code>:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env xonsh</span><span class="go"></span>

<span class="go">ls</span>

<span class="go">print(&#39;removing files&#39;)</span>
<span class="go">rm `file\d+.txt`</span>

<span class="go">ls</span>

<span class="go">print(&#39;adding files&#39;)</span>
<span class="go"># This is a comment</span>
<span class="go">for i, x in enumerate(&quot;xonsh&quot;):</span>
<span class="go">    echo @(x) &gt; @(&quot;file{0}.txt&quot;.format(i))</span>

<span class="go">print($(ls).replace(&#39;\n&#39;, &#39; &#39;))</span>
</pre></div>
</div>
<p>This script could be run by piping its contents to xonsh:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cat test.xsh <span class="p">|</span> xonsh
<span class="go">file0.txt  file1.txt  file2.txt  file3.txt  file4.txt  test_script.sh</span>
<span class="go">removing files</span>
<span class="go">test_script.sh</span>
<span class="go">adding files</span>
<span class="go">file0.txt file1.txt file2.txt file3.txt file4.txt test_script.sh</span>
</pre></div>
</div>
<p>or by invoking xonsh with its filename as an argument:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xonsh test.xsh
<span class="go">file0.txt  file1.txt  file2.txt  file3.txt  file4.txt  test_script.sh</span>
<span class="go">removing files</span>
<span class="go">test_script.sh</span>
<span class="go">adding files</span>
<span class="go">file0.txt file1.txt file2.txt file3.txt file4.txt test_script.sh</span>
</pre></div>
</div>
<p>xonsh scripts can also accept command line arguments and parameters.
These arguments are made available to the script in two different ways:</p>
<ol class="arabic simple">
<li><p>In either mode, as individual variables <code class="docutils literal notranslate"><span class="pre">$ARG&lt;n&gt;</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">$ARG1</span></code>)</p></li>
<li><p>In Python mode only, as a list <code class="docutils literal notranslate"><span class="pre">$ARGS</span></code></p></li>
</ol>
<p>For example, consider a slight variation of the example script from above that
operates on a given argument, rather than on the string <code class="docutils literal notranslate"><span class="pre">'xonsh'</span></code> (notice how
<code class="docutils literal notranslate"><span class="pre">$ARGS</span></code> and <code class="docutils literal notranslate"><span class="pre">$ARG1</span></code> are used):</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env xonsh</span><span class="go"></span>

<span class="go">print($ARGS)</span>

<span class="go">ls</span>

<span class="go">print(&#39;removing files&#39;)</span>
<span class="go">rm `file\d+.txt`</span>

<span class="go">ls</span>

<span class="go">print(&#39;adding files&#39;)</span>
<span class="go"># This is a comment</span>
<span class="go">for i, x in enumerate($ARG1):</span>
<span class="go">    echo @(x) &gt; @(&quot;file{0}.txt&quot;.format(i))</span>

<span class="go">print($(ls).replace(&#39;\n&#39;, &#39; &#39;))</span>
<span class="go">print()</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xonsh test2.xsh snails
<span class="go">[&#39;test_script.sh&#39;, &#39;snails&#39;]</span>
<span class="go">file0.txt  file1.txt  file2.txt  file3.txt  file4.txt  file5.txt  test_script.sh</span>
<span class="go">removing files</span>
<span class="go">test_script.sh</span>
<span class="go">adding files</span>
<span class="go">file0.txt file1.txt file2.txt file3.txt file4.txt file5.txt test_script.sh</span>

<span class="gp">$ </span><span class="nb">echo</span> @<span class="o">(</span><span class="s1">&#39; &#39;</span>.join<span class="o">(</span><span class="k">$(</span>cat @<span class="o">(</span><span class="s1">&#39;file%d.txt&#39;</span> % i<span class="k">)</span><span class="o">)</span>.strip<span class="o">()</span> <span class="k">for</span> i <span class="k">in</span> range<span class="o">(</span><span class="m">6</span><span class="o">)))</span>
<span class="go">s n a i l s</span>
</pre></div>
</div>
<p>Additionally, if the script should exit if a command fails, set the
environment variable <code class="docutils literal notranslate"><span class="pre">$RAISE_SUBPROC_ERROR</span> <span class="pre">=</span> <span class="pre">True</span></code> at the top of the
file. Errors in Python mode will already raise exceptions and so this
is roughly equivalent to Bash’s <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">-e</span></code>.</p>
<p>Furthermore, you can also toggle the ability to print source code lines with the
<code class="docutils literal notranslate"><span class="pre">trace</span> <span class="pre">on</span></code> and <code class="docutils literal notranslate"><span class="pre">trace</span> <span class="pre">off</span></code> commands.  This is roughly equivalent to
Bash’s <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">-x</span></code> or Python’s <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">trace</span></code>, but you know, better.</p>
</section>
<section id="importing-xonsh-xsh">
<h2>Importing Xonsh (<code class="docutils literal notranslate"><span class="pre">*.xsh</span></code>)<a class="headerlink" href="#importing-xonsh-xsh" title="Permalink to this headline">¶</a></h2>
<p>You can import xonsh source files with the <code class="docutils literal notranslate"><span class="pre">*.xsh</span></code> file extension using
the normal Python syntax.  Say you had a file called <code class="docutils literal notranslate"><span class="pre">mine.xsh</span></code>, you could,
therefore, perform a Bash-like source into your current shell with the
following:</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mine</span> <span class="kn">import</span> <span class="o">*</span><span class="go"></span>
</pre></div>
</div>
</section>
<section id="that-s-all-folks">
<h2>That’s All, Folks<a class="headerlink" href="#that-s-all-folks" title="Permalink to this headline">¶</a></h2>
<p>To leave xonsh, hit <code class="docutils literal notranslate"><span class="pre">Ctrl-D</span></code>, type <code class="docutils literal notranslate"><span class="pre">EOF</span></code>, type <code class="docutils literal notranslate"><span class="pre">quit</span></code>, or type <code class="docutils literal notranslate"><span class="pre">exit</span></code>.
On Windows, you can also type <code class="docutils literal notranslate"><span class="pre">Ctrl-Z</span></code>.</p>
<div class="highlight-xonshcon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">exit</span><span class="go"></span>
</pre></div>
</div>
<p>To exit from the xonsh script just call the <code class="docutils literal notranslate"><span class="pre">exit(code)</span></code> function.</p>
<p>Now it is your turn.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="contents.html" title="contents">
          <img class="logo" src="_static/ascii_conch_part_transparent_tight.png" alt="Logo"/>
        </a></p><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="contents.html">Page contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#starting-xonsh">Starting xonsh</a></li>
<li><a class="reference internal" href="#basics">Basics</a></li>
<li><a class="reference internal" href="#environment-variables">Environment Variables</a><ul>
<li><a class="reference internal" href="#the-environment-itself">The Environment Itself <code class="docutils literal notranslate"><span class="pre">${...}</span></code></a></li>
<li><a class="reference internal" href="#environment-lookup-with-expr">Environment Lookup with <code class="docutils literal notranslate"><span class="pre">${&lt;expr&gt;}</span></code></a></li>
<li><a class="reference internal" href="#environment-types">Environment Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-commands">Running Commands</a></li>
<li><a class="reference internal" href="#python-mode-vs-subprocess-mode">Python-mode vs Subprocess-mode</a></li>
<li><a class="reference internal" href="#quoting">Quoting</a></li>
<li><a class="reference internal" href="#captured-subprocess-with-and">Captured Subprocess with <code class="docutils literal notranslate"><span class="pre">$()</span></code> and <code class="docutils literal notranslate"><span class="pre">!()</span></code></a></li>
<li><a class="reference internal" href="#uncaptured-subprocess-with-and">Uncaptured Subprocess with <code class="docutils literal notranslate"><span class="pre">$[]</span></code> and <code class="docutils literal notranslate"><span class="pre">![]</span></code></a></li>
<li><a class="reference internal" href="#python-evaluation-with">Python Evaluation with <code class="docutils literal notranslate"><span class="pre">&#64;()</span></code></a></li>
<li><a class="reference internal" href="#command-substitution-with">Command Substitution with <code class="docutils literal notranslate"><span class="pre">&#64;$()</span></code></a></li>
<li><a class="reference internal" href="#nesting-subprocesses">Nesting Subprocesses</a></li>
<li><a class="reference internal" href="#pipes">Pipes</a></li>
<li><a class="reference internal" href="#logical-subprocess-and">Logical Subprocess And</a></li>
<li><a class="reference internal" href="#logical-subprocess-or">Logical Subprocess Or</a></li>
<li><a class="reference internal" href="#input-output-redirection">Input/Output Redirection</a><ul>
<li><a class="reference internal" href="#redirecting-stdout">Redirecting <code class="docutils literal notranslate"><span class="pre">stdout</span></code></a></li>
<li><a class="reference internal" href="#redirecting-stderr">Redirecting <code class="docutils literal notranslate"><span class="pre">stderr</span></code></a></li>
<li><a class="reference internal" href="#combining-streams">Combining Streams</a></li>
<li><a class="reference internal" href="#redirecting-stdin">Redirecting <code class="docutils literal notranslate"><span class="pre">stdin</span></code></a></li>
<li><a class="reference internal" href="#combining-i-o-redirects">Combining I/O Redirects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#background-jobs">Background Jobs</a></li>
<li><a class="reference internal" href="#job-control">Job Control</a></li>
<li><a class="reference internal" href="#string-literals-in-subprocess-mode">String Literals in Subprocess-mode</a></li>
<li><a class="reference internal" href="#advanced-string-literals">Advanced String Literals</a></li>
<li><a class="reference internal" href="#filename-globbing-with">Filename Globbing with <code class="docutils literal notranslate"><span class="pre">*</span></code></a></li>
<li><a class="reference internal" href="#advanced-path-search-with-backticks">Advanced Path Search with Backticks</a><ul>
<li><a class="reference internal" href="#regular-expression-globbing">Regular Expression Globbing</a></li>
<li><a class="reference internal" href="#normal-globbing">Normal Globbing</a></li>
<li><a class="reference internal" href="#custom-path-searches">Custom Path Searches</a></li>
<li><a class="reference internal" href="#path-output">Path Output</a></li>
<li><a class="reference internal" href="#path-literals">Path Literals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#help-superhelp-with">Help &amp; Superhelp with <code class="docutils literal notranslate"><span class="pre">?</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">??</span></code></a></li>
<li><a class="reference internal" href="#compile-evaluate-execute">Compile, Evaluate, &amp; Execute</a></li>
<li><a class="reference internal" href="#aliases">Aliases</a><ul>
<li><a class="reference internal" href="#callable-aliases">Callable Aliases</a></li>
<li><a class="reference internal" href="#adding-modifying-and-removing-aliases">Adding, Modifying, and Removing Aliases</a></li>
<li><a class="reference internal" href="#anonymous-aliases">Anonymous Aliases</a></li>
<li><a class="reference internal" href="#unthreadable-aliases">Unthreadable Aliases</a></li>
<li><a class="reference internal" href="#uncapturable-aliases">Uncapturable Aliases</a></li>
</ul>
</li>
<li><a class="reference internal" href="#up-down-tab">Up, Down, Tab</a></li>
<li><a class="reference internal" href="#customizing-the-prompt">Customizing the Prompt</a></li>
<li><a class="reference internal" href="#executing-commands-and-scripts">Executing Commands and Scripts</a></li>
<li><a class="reference internal" href="#importing-xonsh-xsh">Importing Xonsh (<code class="docutils literal notranslate"><span class="pre">*.xsh</span></code>)</a></li>
<li><a class="reference internal" href="#that-s-all-folks">That’s All, Folks</a></li>
</ul>
</li>
</ul>

  </div>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="jupyter.html"
                          title="Previous page">&larr; Xonsh kernel for Jupyter</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="tutorial_hist.html"
                          title="Next page">&rarr; Tutorial: History</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="tutorial_hist.html" title="Tutorial: History"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="jupyter.html" title="Xonsh kernel for Jupyter"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="contents.html">xonsh 0.11.0 documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Tutorial</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Anthony Scopatz.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>
